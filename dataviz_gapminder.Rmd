---
title: "Practice generating layered graphics using `ggplot2`"
output:
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(cache = TRUE)
options(digits = 3)
```

```{r packages, cache = FALSE, message = FALSE}
library(tidyverse)
```

Given your preparation for today's class, now let's practice generating layered graphics in R using data from [Gapminder World](https://www.gapminder.org/data/), which compiles country-level data on quality-of-life measures.

# Load the `gapminder` dataset

If you have not already installed the `gapminder` package and you try to load it using the following code, you will get an error:

```{r gapminder-install, eval = FALSE}
library(gapminder)
```

```
Error in library(gapminder) : there is no package called ‘gapminder’
```

If this happens, install the gapminder package by running `install.packages("gapminder")` in your console.

Once you've done this, run the following code to load the gapminder dataset, the `ggplot2` library, and a helper library for printing the contents of `gapminder`:

```{r gapminder}
library(gapminder)
library(ggplot2)
library(tibble)

glimpse(gapminder)
```

> Run `?gapminder` in the console to open the help file for the data and definitions for each of the columns.

Using the grammar of graphics and your knowledge of the `ggplot2` library, generate a series of graphs that explore the relationships between specific variables.

# Exercises

## Generate a histogram of life expectancy

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r histo}
ggplot(data = gapminder, mapping = aes(x = lifeExp)) +
  geom_histogram()
```
  </p>
</details>

### Generate separate histograms of life expectancy for each continent

**Hint: think about how to [split your plots to show different subsets of data.](http://r4ds.had.co.nz/data-visualisation.html#facets)**

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r histo-facet}
ggplot(data = gapminder, mapping = aes(x = lifeExp)) +
  geom_histogram() +
  facet_wrap(~ continent)
```
  </p>
</details>

## Compare the distribution of life expectancy, by continent by generating a boxplot

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r boxplot}
ggplot(data = gapminder, mapping = aes(x = continent, y = lifeExp)) +
  geom_boxplot()
```
  </p>
</details>

### Redraw the plot, but this time use a violin plot

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r violin-plot}
ggplot(data = gapminder, mapping = aes(x = continent, y = lifeExp)) +
  geom_violin()
```
  </p>
</details>

## Generate a scatterplot of the relationship between per capita GDP and life expectancy

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r scatter}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) +
  geom_point()
```
  </p>
</details>

### Add a smoothing line to the scatterplot

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r scatter-smooth}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp)) +
  geom_point() +
  geom_smooth()
```
  </p>
</details>

### Identify whether this relationship differs by continent

#### Use the color aesthetic to identify differences

<details> 
  <summary>Click for the solution</summary>
  <p>
  
```{r scatter-color}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp, color = continent)) +
  geom_point() +
  geom_smooth()
```

  </p>
</details>

#### Use faceting to identify differences

<details> 
  <summary>Click for the solution</summary>
  <p>

```{r scatter-facet}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp, color = continent)) +
  geom_point() +
  geom_smooth() +
  facet_grid(. ~ continent)
```
  </p>
</details>

## Bonus: Identify the outlying countries on the right-side of the graph by labeling each observation with the country name

<details> 
  <summary>Click for the solution</summary>
  <p>
```{r text}
ggplot(data = gapminder, mapping = aes(x = gdpPercap, y = lifeExp, label = country)) +
  geom_smooth() +
  geom_text()
```
  </p>
</details>


# Session Info {.toc-ignore}

```{r child='_sessioninfo.Rmd'}
```





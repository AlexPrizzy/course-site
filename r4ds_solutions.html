<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>R for Data Science</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45631879-2', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computing for the Social Sciences</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="faq.html">FAQ</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R for Data Science</h1>
<h3 class="subtitle"><em>Exercise answer key</em></h3>

</div>


<p>This is a work-in-progress answer key for the exercises in Hadley Wickham’s <a href="http://r4ds.had.co.nz/">R for Data Science</a>. For many questions, there is more than one correct answer. This is simply what I came up with, attempting to limit myself to only using operations and functions the reader has seen in previous chapters.</p>
<blockquote>
<p>See an error or want to add an answer? <a href="https://github.com/uc-cfss/uc-cfss.github.io/pulls">Submit a pull request.</a></p>
</blockquote>
<div id="load-prerequisites" class="section level1 toc-ignore">
<h1>Load prerequisites</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="co">#&gt; Loading tidyverse: ggplot2</span>
<span class="co">#&gt; Loading tidyverse: tibble</span>
<span class="co">#&gt; Loading tidyverse: tidyr</span>
<span class="co">#&gt; Loading tidyverse: readr</span>
<span class="co">#&gt; Loading tidyverse: purrr</span>
<span class="co">#&gt; Loading tidyverse: dplyr</span>
<span class="co">#&gt; Conflicts with tidy packages ----------------------------------------------</span>
<span class="co">#&gt; filter(): dplyr, stats</span>
<span class="co">#&gt; lag():    dplyr, stats</span></code></pre></div>
</div>
<div id="data-visualization" class="section level1">
<h1>3 Data visualization</h1>
<div id="exercises" class="section level2">
<h2>3.2.4 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Run <code>ggplot(data = mpg)</code> what do you see?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-1-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>How many rows are in <code>mtcars</code>? How many columns?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># one approach</span>
<span class="kw">nrow</span>(mtcars)
<span class="co">#&gt; [1] 32</span>
<span class="kw">ncol</span>(mtcars)
<span class="co">#&gt; [1] 11</span>

<span class="co"># another approach</span>
<span class="kw">dim</span>(mtcars)
<span class="co">#&gt; [1] 32 11</span></code></pre></div></li>
<li><p>What does the <code>drv</code> variable describe? Read the help for <code>?mpg</code> to find out.</p>
<p><code>drv</code> indicates whether the vehicle is front-wheel drive, rear wheel drive, or 4 wheel drive.</p></li>
<li><p>Make a scatterplot of <code>hwy</code> vs <code>cyl</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hwy, <span class="dt">y =</span> cyl))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What happens if you make a scatterplot of <code>class</code> vs <code>drv</code>. Why is the plot not useful?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">y =</span> drv))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The variables are both categorical, so the points on the plot overlap with one another.</p></li>
</ol>
</div>
<div id="exercises-1" class="section level2">
<h2>3.3.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>What’s gone wrong with this code? Why are the points not blue?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Because the <code>color</code> argument was set within <code>aes()</code>, not <code>geom_point()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Which variables in <code>mpg</code> are categorical? Which variables are continuous? (Hint: type <code>?mpg</code> to read the documentation for the dataset). How can you see this information when you run <code>mpg</code>?</p>
<ul>
<li>Categorical - <code>manufacturer</code>, <code>model</code>, <code>trans</code>, <code>drv</code>, <code>fl</code>, <code>class</code></li>
<li>Continuous - <code>displ</code>, <code>cyl</code>, <code>cty</code>, <code>hwy</code></li>
<li>Categorical variables are type <code>chr</code>, whereas continuous variables are type <code>dbl</code> or <code>int</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mpg
<span class="co">#&gt; # A tibble: 234 × 11</span>
<span class="co">#&gt;    manufacturer      model displ  year   cyl      trans   drv   cty   hwy</span>
<span class="co">#&gt;           &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;      &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1          audi         a4   1.8  1999     4   auto(l5)     f    18    29</span>
<span class="co">#&gt; 2          audi         a4   1.8  1999     4 manual(m5)     f    21    29</span>
<span class="co">#&gt; 3          audi         a4   2.0  2008     4 manual(m6)     f    20    31</span>
<span class="co">#&gt; 4          audi         a4   2.0  2008     4   auto(av)     f    21    30</span>
<span class="co">#&gt; 5          audi         a4   2.8  1999     6   auto(l5)     f    16    26</span>
<span class="co">#&gt; 6          audi         a4   2.8  1999     6 manual(m5)     f    18    26</span>
<span class="co">#&gt; 7          audi         a4   3.1  2008     6   auto(av)     f    18    27</span>
<span class="co">#&gt; 8          audi a4 quattro   1.8  1999     4 manual(m5)     4    18    26</span>
<span class="co">#&gt; 9          audi a4 quattro   1.8  1999     4   auto(l5)     4    16    25</span>
<span class="co">#&gt; 10         audi a4 quattro   2.0  2008     4 manual(m6)     4    20    28</span>
<span class="co">#&gt; # ... with 224 more rows, and 2 more variables: fl &lt;chr&gt;, class &lt;chr&gt;</span></code></pre></div></li>
<li><p>Map a continuous variable to <code>color</code>, <code>size</code>, and <code>shape</code>. How do these aesthetics behave differently for categorical vs. continuous variables?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># color</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> cty))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># size</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">size =</span> cty))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-8-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># shape</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">shape =</span> cty))
<span class="co">#&gt; Error: A continuous variable can not be mapped to shape</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-8-3.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For these aesthetics, continuous variables are visualized on a spectrum (see the color plot with the continuous color palette), whereas categorical variables are binned into discrete categories, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> class))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What happens if you map the same variable to multiple aesthetics?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> cty, <span class="dt">size =</span> cty))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Both aesthetics are implemented, and multiple legends are generated.</p></li>
<li><p>What does the <code>stroke</code> aesthetic do? What shapes does it work with? (Hint: use <code>?geom_point</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy), <span class="dt">stroke =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">21</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>stroke</code> adjusts the thickness of the border for shapes that can take on different colors both inside and outside. <a href="http://docs.ggplot2.org/current/vignettes/ggplot2-specs.html">It only works for shapes 21-24.</a></p>
<p><img src="r4ds_solutions_files/figure-html/shapes-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What happens if you map an aesthetic to something other than a variable name, like <code>aes(colour = displ &lt; 5)</code>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> displ <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>R executes the code and creates a temporary variable containing the results of the operation. Here, the new variable takes on a value of <code>TRUE</code> if the engine displacement is less than 5 or <code>FALSE</code> if the engine displacement is more than or equal to 5.</p></li>
</ol>
</div>
<div id="exercises-2" class="section level2">
<h2>3.5.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>What happens if you facet on a continuous variable?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> drv, <span class="dt">y =</span> cyl)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>displ)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Your graph will not make much sense. R will try to draw a separate facet for each unique value of the continuous variable. If you have too many unique values, you may crash R.</p></li>
<li><p>What do the empty cells in plot with <code>facet_grid(drv ~ cyl)</code> mean? How do they relate to this plot?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> drv, <span class="dt">y =</span> cyl))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> drv, <span class="dt">y =</span> cyl)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>cyl)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Empty cells mean there are no observations in the data that have that unique combination of values. For instance, in this plot we can determine that there are no vehicles with 5 cylinders that are also 4 wheel drive vehicles. The plot is similar to the original one, just that each facet only appears to have a single data point.</p></li>
<li><p>What plots does the following code make? What does <code>.</code> do?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>.)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>cyl)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-16-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>.</code> acts a placeholder for no variable. In <code>facet_grid()</code>, this results in a plot faceted on a single dimension (1 by <span class="math inline">\(N\)</span> or <span class="math inline">\(N\)</span> by 1) rather than an <span class="math inline">\(N\)</span> by <span class="math inline">\(N\)</span> grid.</p></li>
<li><p>Take the first faceted plot in this section:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>class, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>What are the advantages to using faceting instead of the colour aesthetic? What are the disadvantages? How might the balance change if you had a larger dataset?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> class))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Faceting splits the data into separate grids and better visualizes trends within each individual facet. The disadvantage is that by doing so, it is harder to visualize the overall relationship across facets. The color aesthetic is fine when your dataset is small, but with larger datasets points may begin to overlap with one another. In this situation with a colored plot, jittering may not be sufficient because of the additional color aesthetic.</p></li>
<li><p>Read <code>?facet_wrap</code>. What does <code>nrow</code> do? What does <code>ncol</code> do? What other options control the layout of the individual panels? Why doesn’t <code>facet_grid()</code> have <code>nrow</code> and <code>ncol</code> variables?</p>
<ol style="list-style-type: decimal">
<li><code>nrow</code> sets how many rows the faceted plot will have.</li>
<li><code>ncol</code> sets how many columns the faceted plot will have.</li>
<li><code>as.table</code> determines the starting facet to begin filling the plot, and <code>dir</code> determines the starting direction for filling in the plot (horizontal or vertical).</li>
</ol></li>
<li><p>When using <code>facet_grid()</code> you should usually put the variable with more unique levels in the columns. Why?</p>
<p>This will extend the plot vertically, where you typically have more viewing space. If you extend it horizontally, the plot will be compressed and harder to view.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(trans <span class="op">~</span><span class="st"> </span>drv)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>trans)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-19-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div id="exercises-3" class="section level2">
<h2>3.6.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?</p>
<ul>
<li>Line chart - <code>geom_line()</code></li>
<li>Boxplot - <code>geom_boxplot()</code></li>
<li>Histogram - <code>geom_histogram()</code></li>
<li>Area chart - <code>geom_area()</code></li>
</ul></li>
<li><p>Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> drv)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39;</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What does <code>show.legend = FALSE</code> do? What happens if you remove it?<br />
Why do you think I used it earlier in the chapter?</p>
<p>It removes the legend. The aesthetics are still mapped and plotted, but the key is removed from the graph. I don’t know why used it earlier because he actually did not.</p></li>
<li><p>What does the <code>se</code> argument to <code>geom_smooth()</code> do?</p>
<p>It determines whether or not to draw a confidence interval around the smoothing line.</p></li>
<li><p>Will these two graphs look different? Why/why not?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>()
<span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39;</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))
<span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39;</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-21-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>No because they use the same data and mapping settings. The only difference is that by storing it in the <code>ggplot()</code> function, it is automatically reused for each layer.</p></li>
<li><p>Recreate the R code necessary to generate the following graphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-22-1.png" width="70%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> drv), <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-22-2.png" width="70%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> drv)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-22-3.png" width="70%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> drv)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-22-4.png" width="70%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> drv)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> drv), <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-22-5.png" width="70%" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> drv))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-22-6.png" width="70%" /></p></li>
</ol>
</div>
<div id="exercises-4" class="section level2">
<h2>3.8.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>What is the default geom associated with <code>stat_summary()</code>? How could you rewrite the previous plot to use that geom function instead of the stat function?</p>
<p>The default geom is <code>geom_pointrange()</code>. Rewritten, we could use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> depth),
                  <span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>,
                  <span class="dt">fun.ymin =</span> min,
                  <span class="dt">fun.ymax =</span> max,
                  <span class="dt">fun.y =</span> median)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What does <code>geom_col()</code> do? How is it different to <code>geom_bar()</code>?</p>
<p><code>geom_bar()</code> uses the <code>stat_count()</code> statistical transformation to draw the bar graph. <code>geom_col()</code> assumes the values have already been transformed to the appropriate values. <code>geom_bar(stat = &quot;identity&quot;)</code> and <code>geom_col()</code> are equivalent.</p></li>
<li><p>Most geoms and stats come in pairs that are almost always used in concert. Read through the documentation and make a list of all the pairs. What do they have in common?</p></li>
<li><p>What variables does <code>stat_smooth()</code> compute? What parameters control its behaviour?</p>
<p><code>stat_smooth()</code> calculates four variables:</p>
<ol style="list-style-type: decimal">
<li><code>y</code> - predicted value</li>
<li><code>ymin</code> - lower pointwise confidence interval around the mean</li>
<li><code>ymax</code> - upper pointwise confidence interval around the mean</li>
<li><code>se</code> - standard error</li>
</ol>
<p>See <code>?stat_smooth</code> for more details on the specific parameters. Most importantly, <code>method</code> controls the smoothing method to be employed, <code>se</code> determines whether confidence interval should be plotted, and <code>level</code> determines the level of confidence interval to use.</p></li>
<li><p>In our proportion bar chart, we need to set <code>group = 1</code>. Why? In other words what is the problem with these two graphs?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..prop..))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> color, <span class="dt">y =</span> ..prop..))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-24-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>If we fail to set <code>group = 1</code>, the proportions for each cut are calculated using the complete dataset, rather than each subset of <code>cut</code>. Instead, we want the graphs to look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> color, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-25-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div id="exercises-5" class="section level2">
<h2>3.8.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>What is the problem with this plot? How could you improve it?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Many of the data points overlap. We can jitter the points by adding some slight random noise, which will improve the overall visualization.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What parameters to <code>geom_jitter()</code> control the amount of jittering?</p>
<p><code>width</code> and <code>height</code>.</p></li>
<li><p>Compare and contrast <code>geom_jitter()</code> with <code>geom_count()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_count</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-28-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Rather than adding random noise, <code>geom_count()</code> counts the number of observations at each location, then maps the count to point area. It makes larger points the more observations are located at that area, so the number of visible points is equal to <code>geom_point()</code>.</p></li>
<li><p>What’s the default position adjustment for <code>geom_boxplot()</code>? Create a visualisation of the <code>mpg</code> dataset that demonstrates it.</p>
<p>The default position adjustment is <code>position_dodge()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">y =</span> hwy, <span class="dt">color =</span> drv)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<div id="exercises-6" class="section level2">
<h2>3.9.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Turn a stacked bar chart into a pie chart using <code>coord_polar()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="dv">1</span>), <span class="dt">fill =</span> class)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What does <code>labs()</code> do? Read the documentation.</p>
<p><code>labs()</code> adds labels to the graph. You can add a title, subtitle, and a label for the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axes, as well as a caption.</p></li>
<li><p>What’s the difference between <code>coord_quickmap()</code> and <code>coord_map()</code>?</p>
<p><code>coord_map()</code> projects a portion of the earth (a three-dimensional object) onto a flat (two-dimensional) plane. <code>coord_map()</code> does not preserve straight lines and therefore is computationally intensive; <code>coord_quickmap()</code> preserves straight lines and is therefore faster to draw (though less accurate).</p></li>
<li><p>What does the plot below tell you about the relationship between city and highway mpg? Why is <code>coord_fixed()</code> important? What does <code>geom_abline()</code> do?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_abline</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_fixed</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The relationships is approximately linear, though overall cars have slightly better highway mileage than city mileage. But using <code>coord_fixed()</code>, the plot draws equal intervals on the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axes so they are directly comparable. <code>geom_abline()</code> draws a line that, by default, has an intercept of 0 and slope of 1. This aids us in our discovery that automobile gas efficiency is on average slightly higher for highways than city driving, though the slope of the relationship is still roughly 1-to-1.</p></li>
</ol>
</div>
</div>
<div id="workflow-basics" class="section level1">
<h1>4 Workflow: basics</h1>
<div id="practice" class="section level2">
<h2>4.4 Practice</h2>
<ol style="list-style-type: decimal">
<li><p>Why does this code not work?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_variable &lt;-<span class="st"> </span><span class="dv">10</span>
my_varıable
<span class="co">#&gt; Error in eval(expr, envir, enclos): object &#39;my_varıable&#39; not found</span></code></pre></div>
<p>The second line has a typo. It should be <code>my_variable</code>, not <code>my_varıable</code>.</p></li>
<li><p>Tweak each of the following R commands so that they run correctly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

<span class="co"># incorrect</span>
<span class="kw">ggplot</span>(<span class="dt">dota =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))
<span class="co">#&gt; Error in structure(list(data = data, layers = list(), scales = scales_list(), : argument &quot;data&quot; is missing, with no default</span>

<span class="co"># correct</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># incorrect</span>
<span class="kw">fliter</span>(mpg, <span class="dt">cyl =</span> <span class="dv">8</span>)
<span class="co">#&gt; Error in eval(expr, envir, enclos): could not find function &quot;fliter&quot;</span>
<span class="kw">filter</span>(diamond, carat <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)
<span class="co">#&gt; Error in filter_(.data, .dots = lazyeval::lazy_dots(...)): object &#39;diamond&#39; not found</span>

<span class="co"># correct</span>
<span class="kw">filter</span>(mpg, cyl <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)
<span class="co">#&gt; # A tibble: 70 × 11</span>
<span class="co">#&gt;    manufacturer              model displ  year   cyl      trans   drv</span>
<span class="co">#&gt;           &lt;chr&gt;              &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;      &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1          audi         a6 quattro   4.2  2008     8   auto(s6)     4</span>
<span class="co">#&gt; 2     chevrolet c1500 suburban 2wd   5.3  2008     8   auto(l4)     r</span>
<span class="co">#&gt; 3     chevrolet c1500 suburban 2wd   5.3  2008     8   auto(l4)     r</span>
<span class="co">#&gt; 4     chevrolet c1500 suburban 2wd   5.3  2008     8   auto(l4)     r</span>
<span class="co">#&gt; 5     chevrolet c1500 suburban 2wd   5.7  1999     8   auto(l4)     r</span>
<span class="co">#&gt; 6     chevrolet c1500 suburban 2wd   6.0  2008     8   auto(l4)     r</span>
<span class="co">#&gt; 7     chevrolet           corvette   5.7  1999     8 manual(m6)     r</span>
<span class="co">#&gt; 8     chevrolet           corvette   5.7  1999     8   auto(l4)     r</span>
<span class="co">#&gt; 9     chevrolet           corvette   6.2  2008     8 manual(m6)     r</span>
<span class="co">#&gt; 10    chevrolet           corvette   6.2  2008     8   auto(s6)     r</span>
<span class="co">#&gt; # ... with 60 more rows, and 4 more variables: cty &lt;int&gt;, hwy &lt;int&gt;,</span>
<span class="co">#&gt; #   fl &lt;chr&gt;, class &lt;chr&gt;</span>
<span class="kw">filter</span>(diamonds, carat <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)
<span class="co">#&gt; # A tibble: 32 × 10</span>
<span class="co">#&gt;    carat     cut color clarity depth table price     x     y     z</span>
<span class="co">#&gt;    &lt;dbl&gt;   &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   3.01 Premium     I      I1  62.7    58  8040  9.10  8.97  5.67</span>
<span class="co">#&gt; 2   3.11    Fair     J      I1  65.9    57  9823  9.15  9.02  5.98</span>
<span class="co">#&gt; 3   3.01 Premium     F      I1  62.2    56  9925  9.24  9.13  5.73</span>
<span class="co">#&gt; 4   3.05 Premium     E      I1  60.9    58 10453  9.26  9.25  5.66</span>
<span class="co">#&gt; 5   3.02    Fair     I      I1  65.2    56 10577  9.11  9.02  5.91</span>
<span class="co">#&gt; 6   3.01    Fair     H      I1  56.1    62 10761  9.54  9.38  5.31</span>
<span class="co">#&gt; 7   3.65    Fair     H      I1  67.1    53 11668  9.53  9.48  6.38</span>
<span class="co">#&gt; 8   3.24 Premium     H      I1  62.1    58 12300  9.44  9.40  5.85</span>
<span class="co">#&gt; 9   3.22   Ideal     I      I1  62.6    55 12545  9.49  9.42  5.92</span>
<span class="co">#&gt; 10  3.50   Ideal     H      I1  62.8    57 12587  9.65  9.59  6.03</span>
<span class="co">#&gt; # ... with 22 more rows</span></code></pre></div></li>
<li><p>Press Alt + Shift + K. What happens? How can you get to the same place using the menus?</p>
<p>The keyboard shortcuts help display appears. To access it from the menus, go to <em>Help</em> &gt; <em>Keyboard Shortcuts Help</em></p></li>
</ol>
</div>
</div>
<div id="data-transformation" class="section level1">
<h1>5 Data transformation</h1>
<div id="exercises-7" class="section level2">
<h2>5.7.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Find all flights that</p>
<ol style="list-style-type: decimal">
<li><p>Had an arrival delay of two or more hours</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)
<span class="kw">filter</span>(flights, arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">120</span>)
<span class="co">#&gt; # A tibble: 10,200 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1      811            630       101     1047</span>
<span class="co">#&gt; 2   2013     1     1      848           1835       853     1001</span>
<span class="co">#&gt; 3   2013     1     1      957            733       144     1056</span>
<span class="co">#&gt; 4   2013     1     1     1114            900       134     1447</span>
<span class="co">#&gt; 5   2013     1     1     1505           1310       115     1638</span>
<span class="co">#&gt; 6   2013     1     1     1525           1340       105     1831</span>
<span class="co">#&gt; 7   2013     1     1     1549           1445        64     1912</span>
<span class="co">#&gt; 8   2013     1     1     1558           1359       119     1718</span>
<span class="co">#&gt; 9   2013     1     1     1732           1630        62     2028</span>
<span class="co">#&gt; 10  2013     1     1     1803           1620       103     2008</span>
<span class="co">#&gt; # ... with 10,190 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Flew to Houston (<code>IAH</code> or <code>HOU</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, dest <span class="op">==</span><span class="st"> &quot;IAH&quot;</span> <span class="op">|</span><span class="st"> </span>dest <span class="op">==</span><span class="st"> &quot;HOU&quot;</span>)
<span class="co">#&gt; # A tibble: 9,313 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1      517            515         2      830</span>
<span class="co">#&gt; 2   2013     1     1      533            529         4      850</span>
<span class="co">#&gt; 3   2013     1     1      623            627        -4      933</span>
<span class="co">#&gt; 4   2013     1     1      728            732        -4     1041</span>
<span class="co">#&gt; 5   2013     1     1      739            739         0     1104</span>
<span class="co">#&gt; 6   2013     1     1      908            908         0     1228</span>
<span class="co">#&gt; 7   2013     1     1     1028           1026         2     1350</span>
<span class="co">#&gt; 8   2013     1     1     1044           1045        -1     1352</span>
<span class="co">#&gt; 9   2013     1     1     1114            900       134     1447</span>
<span class="co">#&gt; 10  2013     1     1     1205           1200         5     1503</span>
<span class="co">#&gt; # ... with 9,303 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Were operated by United, American, or Delta</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, carrier <span class="op">==</span><span class="st"> &quot;UA&quot;</span> <span class="op">|</span>
<span class="st">         </span>carrier <span class="op">==</span><span class="st"> &quot;AA&quot;</span> <span class="op">|</span>
<span class="st">         </span>carrier <span class="op">==</span><span class="st"> &quot;DL&quot;</span>)
<span class="co">#&gt; # A tibble: 139,504 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1      517            515         2      830</span>
<span class="co">#&gt; 2   2013     1     1      533            529         4      850</span>
<span class="co">#&gt; 3   2013     1     1      542            540         2      923</span>
<span class="co">#&gt; 4   2013     1     1      554            600        -6      812</span>
<span class="co">#&gt; 5   2013     1     1      554            558        -4      740</span>
<span class="co">#&gt; 6   2013     1     1      558            600        -2      753</span>
<span class="co">#&gt; 7   2013     1     1      558            600        -2      924</span>
<span class="co">#&gt; 8   2013     1     1      558            600        -2      923</span>
<span class="co">#&gt; 9   2013     1     1      559            600        -1      941</span>
<span class="co">#&gt; 10  2013     1     1      559            600        -1      854</span>
<span class="co">#&gt; # ... with 139,494 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Departed in summer (July, August, and September)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, month <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>, month <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>)
<span class="co">#&gt; # A tibble: 86,326 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     7     1        1           2029       212      236</span>
<span class="co">#&gt; 2   2013     7     1        2           2359         3      344</span>
<span class="co">#&gt; 3   2013     7     1       29           2245       104      151</span>
<span class="co">#&gt; 4   2013     7     1       43           2130       193      322</span>
<span class="co">#&gt; 5   2013     7     1       44           2150       174      300</span>
<span class="co">#&gt; 6   2013     7     1       46           2051       235      304</span>
<span class="co">#&gt; 7   2013     7     1       48           2001       287      308</span>
<span class="co">#&gt; 8   2013     7     1       58           2155       183      335</span>
<span class="co">#&gt; 9   2013     7     1      100           2146       194      327</span>
<span class="co">#&gt; 10  2013     7     1      100           2245       135      337</span>
<span class="co">#&gt; # ... with 86,316 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Arrived more than two hours late, but didn’t leave late</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">120</span>, dep_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)
<span class="co">#&gt; # A tibble: 29 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1    27     1419           1420        -1     1754</span>
<span class="co">#&gt; 2   2013    10     7     1350           1350         0     1736</span>
<span class="co">#&gt; 3   2013    10     7     1357           1359        -2     1858</span>
<span class="co">#&gt; 4   2013    10    16      657            700        -3     1258</span>
<span class="co">#&gt; 5   2013    11     1      658            700        -2     1329</span>
<span class="co">#&gt; 6   2013     3    18     1844           1847        -3       39</span>
<span class="co">#&gt; 7   2013     4    17     1635           1640        -5     2049</span>
<span class="co">#&gt; 8   2013     4    18      558            600        -2     1149</span>
<span class="co">#&gt; 9   2013     4    18      655            700        -5     1213</span>
<span class="co">#&gt; 10  2013     5    22     1827           1830        -3     2217</span>
<span class="co">#&gt; # ... with 19 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Were delayed by at least an hour, but made up over 30 minutes in flight</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, dep_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60</span>, dep_delay <span class="op">-</span><span class="st"> </span>arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>)
<span class="co">#&gt; # A tibble: 2,074 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1     1716           1545        91     2140</span>
<span class="co">#&gt; 2   2013     1     1     2205           1720       285       46</span>
<span class="co">#&gt; 3   2013     1     1     2326           2130       116      131</span>
<span class="co">#&gt; 4   2013     1     3     1503           1221       162     1803</span>
<span class="co">#&gt; 5   2013     1     3     1821           1530       171     2131</span>
<span class="co">#&gt; 6   2013     1     3     1839           1700        99     2056</span>
<span class="co">#&gt; 7   2013     1     3     1850           1745        65     2148</span>
<span class="co">#&gt; 8   2013     1     3     1923           1815        68     2036</span>
<span class="co">#&gt; 9   2013     1     3     1941           1759       102     2246</span>
<span class="co">#&gt; 10  2013     1     3     1950           1845        65     2228</span>
<span class="co">#&gt; # ... with 2,064 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Departed between midnight and 6am (inclusive)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, dep_time <span class="op">&gt;=</span><span class="dv">0</span>, dep_time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)
<span class="co">#&gt; # A tibble: 9,344 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1      517            515         2      830</span>
<span class="co">#&gt; 2   2013     1     1      533            529         4      850</span>
<span class="co">#&gt; 3   2013     1     1      542            540         2      923</span>
<span class="co">#&gt; 4   2013     1     1      544            545        -1     1004</span>
<span class="co">#&gt; 5   2013     1     1      554            600        -6      812</span>
<span class="co">#&gt; 6   2013     1     1      554            558        -4      740</span>
<span class="co">#&gt; 7   2013     1     1      555            600        -5      913</span>
<span class="co">#&gt; 8   2013     1     1      557            600        -3      709</span>
<span class="co">#&gt; 9   2013     1     1      557            600        -3      838</span>
<span class="co">#&gt; 10  2013     1     1      558            600        -2      753</span>
<span class="co">#&gt; # ... with 9,334 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
</ol></li>
<li><p>Another useful dplyr filtering helper is <code>between()</code>. What does it do? Can you use it to simplify the code needed to answer the previous challenges?</p>
<p>It is a shortcut for finding observations between two values. For example, we can simplify this code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, month <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>, month <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>)
<span class="co">#&gt; # A tibble: 86,326 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     7     1        1           2029       212      236</span>
<span class="co">#&gt; 2   2013     7     1        2           2359         3      344</span>
<span class="co">#&gt; 3   2013     7     1       29           2245       104      151</span>
<span class="co">#&gt; 4   2013     7     1       43           2130       193      322</span>
<span class="co">#&gt; 5   2013     7     1       44           2150       174      300</span>
<span class="co">#&gt; 6   2013     7     1       46           2051       235      304</span>
<span class="co">#&gt; 7   2013     7     1       48           2001       287      308</span>
<span class="co">#&gt; 8   2013     7     1       58           2155       183      335</span>
<span class="co">#&gt; 9   2013     7     1      100           2146       194      327</span>
<span class="co">#&gt; 10  2013     7     1      100           2245       135      337</span>
<span class="co">#&gt; # ... with 86,316 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
<span class="kw">filter</span>(flights, <span class="kw">between</span>(month, <span class="dv">7</span>, <span class="dv">9</span>))
<span class="co">#&gt; # A tibble: 86,326 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     7     1        1           2029       212      236</span>
<span class="co">#&gt; 2   2013     7     1        2           2359         3      344</span>
<span class="co">#&gt; 3   2013     7     1       29           2245       104      151</span>
<span class="co">#&gt; 4   2013     7     1       43           2130       193      322</span>
<span class="co">#&gt; 5   2013     7     1       44           2150       174      300</span>
<span class="co">#&gt; 6   2013     7     1       46           2051       235      304</span>
<span class="co">#&gt; 7   2013     7     1       48           2001       287      308</span>
<span class="co">#&gt; 8   2013     7     1       58           2155       183      335</span>
<span class="co">#&gt; 9   2013     7     1      100           2146       194      327</span>
<span class="co">#&gt; 10  2013     7     1      100           2245       135      337</span>
<span class="co">#&gt; # ... with 86,316 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>How many flights have a missing <code>dep_time</code>? What other variables are missing? What might these rows represent?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(flights, <span class="kw">is.na</span>(dep_time))
<span class="co">#&gt; # A tibble: 8,255 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1       NA           1630        NA       NA</span>
<span class="co">#&gt; 2   2013     1     1       NA           1935        NA       NA</span>
<span class="co">#&gt; 3   2013     1     1       NA           1500        NA       NA</span>
<span class="co">#&gt; 4   2013     1     1       NA            600        NA       NA</span>
<span class="co">#&gt; 5   2013     1     2       NA           1540        NA       NA</span>
<span class="co">#&gt; 6   2013     1     2       NA           1620        NA       NA</span>
<span class="co">#&gt; 7   2013     1     2       NA           1355        NA       NA</span>
<span class="co">#&gt; 8   2013     1     2       NA           1420        NA       NA</span>
<span class="co">#&gt; 9   2013     1     2       NA           1321        NA       NA</span>
<span class="co">#&gt; 10  2013     1     2       NA           1545        NA       NA</span>
<span class="co">#&gt; # ... with 8,245 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div>
<p>They are also missing values for arrival time and departure/arrival delay. Most likely these are scheduled flights that never flew.</p></li>
<li><p>Why is <code>NA ^ 0</code> not missing? Why is <code>NA | TRUE</code> not missing? Why is <code>FALSE &amp; NA</code> not missing? Can you figure out the general rule? (<code>NA * 0</code> is a tricky counterexample!)</p>
<ul>
<li><code>NA ^ 0</code> - by definition anything to the 0th power is 1.</li>
<li><code>NA | TRUE</code> - as long as one condition is <code>TRUE</code>, the result is <code>TRUE</code>. By definition, <code>TRUE</code> is <code>TRUE</code>.</li>
<li><code>FALSE &amp; NA</code> - <code>NA</code> indicates the absence of a value, so the conditional expression ignores it.</li>
<li>In general any operation on a missing value becomes a missing value. Hence <code>NA * 0</code> is <code>NA</code>. In conditional expressions, missing values are simply ignored.</li>
</ul></li>
</ol>
</div>
<div id="exercises-8" class="section level2">
<h2>5.3.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>How could you use <code>arrange()</code> to sort all missing values to the start? (Hint: use <code>is.na()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">arrange</span>(data, <span class="op">!</span><span class="kw">is.na</span>(.))</code></pre></div>
<p>A working example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">arrange</span>(flights, <span class="op">!</span><span class="kw">is.na</span>(dep_time))
<span class="co">#&gt; # A tibble: 336,776 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1       NA           1630        NA       NA</span>
<span class="co">#&gt; 2   2013     1     1       NA           1935        NA       NA</span>
<span class="co">#&gt; 3   2013     1     1       NA           1500        NA       NA</span>
<span class="co">#&gt; 4   2013     1     1       NA            600        NA       NA</span>
<span class="co">#&gt; 5   2013     1     2       NA           1540        NA       NA</span>
<span class="co">#&gt; 6   2013     1     2       NA           1620        NA       NA</span>
<span class="co">#&gt; 7   2013     1     2       NA           1355        NA       NA</span>
<span class="co">#&gt; 8   2013     1     2       NA           1420        NA       NA</span>
<span class="co">#&gt; 9   2013     1     2       NA           1321        NA       NA</span>
<span class="co">#&gt; 10  2013     1     2       NA           1545        NA       NA</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Sort <code>flights</code> to find the most delayed flights. Find the flights that left earliest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># most delayed (based on arrival)</span>
<span class="kw">arrange</span>(flights, <span class="kw">desc</span>(arr_delay))
<span class="co">#&gt; # A tibble: 336,776 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     9      641            900      1301     1242</span>
<span class="co">#&gt; 2   2013     6    15     1432           1935      1137     1607</span>
<span class="co">#&gt; 3   2013     1    10     1121           1635      1126     1239</span>
<span class="co">#&gt; 4   2013     9    20     1139           1845      1014     1457</span>
<span class="co">#&gt; 5   2013     7    22      845           1600      1005     1044</span>
<span class="co">#&gt; 6   2013     4    10     1100           1900       960     1342</span>
<span class="co">#&gt; 7   2013     3    17     2321            810       911      135</span>
<span class="co">#&gt; 8   2013     7    22     2257            759       898      121</span>
<span class="co">#&gt; 9   2013    12     5      756           1700       896     1058</span>
<span class="co">#&gt; 10  2013     5     3     1133           2055       878     1250</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>

<span class="co"># left earliest</span>
<span class="kw">arrange</span>(flights, dep_delay)
<span class="co">#&gt; # A tibble: 336,776 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013    12     7     2040           2123       -43       40</span>
<span class="co">#&gt; 2   2013     2     3     2022           2055       -33     2240</span>
<span class="co">#&gt; 3   2013    11    10     1408           1440       -32     1549</span>
<span class="co">#&gt; 4   2013     1    11     1900           1930       -30     2233</span>
<span class="co">#&gt; 5   2013     1    29     1703           1730       -27     1947</span>
<span class="co">#&gt; 6   2013     8     9      729            755       -26     1002</span>
<span class="co">#&gt; 7   2013    10    23     1907           1932       -25     2143</span>
<span class="co">#&gt; 8   2013     3    30     2030           2055       -25     2213</span>
<span class="co">#&gt; 9   2013     3     2     1431           1455       -24     1601</span>
<span class="co">#&gt; 10  2013     5     5      934            958       -24     1225</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Sort <code>flights</code> to find the fastest flights.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">arrange</span>(flights, <span class="kw">desc</span>(distance <span class="op">/</span><span class="st"> </span>air_time))
<span class="co">#&gt; # A tibble: 336,776 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     5    25     1709           1700         9     1923</span>
<span class="co">#&gt; 2   2013     7     2     1558           1513        45     1745</span>
<span class="co">#&gt; 3   2013     5    13     2040           2025        15     2225</span>
<span class="co">#&gt; 4   2013     3    23     1914           1910         4     2045</span>
<span class="co">#&gt; 5   2013     1    12     1559           1600        -1     1849</span>
<span class="co">#&gt; 6   2013    11    17      650            655        -5     1059</span>
<span class="co">#&gt; 7   2013     2    21     2355           2358        -3      412</span>
<span class="co">#&gt; 8   2013    11    17      759            800        -1     1212</span>
<span class="co">#&gt; 9   2013    11    16     2003           1925        38       17</span>
<span class="co">#&gt; 10  2013    11    16     2349           2359       -10      402</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
<li><p>Which flights travelled the longest? Which travelled the shortest?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># longest flights by distance</span>
<span class="kw">arrange</span>(flights, <span class="kw">desc</span>(distance))
<span class="co">#&gt; # A tibble: 336,776 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     1      857            900        -3     1516</span>
<span class="co">#&gt; 2   2013     1     2      909            900         9     1525</span>
<span class="co">#&gt; 3   2013     1     3      914            900        14     1504</span>
<span class="co">#&gt; 4   2013     1     4      900            900         0     1516</span>
<span class="co">#&gt; 5   2013     1     5      858            900        -2     1519</span>
<span class="co">#&gt; 6   2013     1     6     1019            900        79     1558</span>
<span class="co">#&gt; 7   2013     1     7     1042            900       102     1620</span>
<span class="co">#&gt; 8   2013     1     8      901            900         1     1504</span>
<span class="co">#&gt; 9   2013     1     9      641            900      1301     1242</span>
<span class="co">#&gt; 10  2013     1    10      859            900        -1     1449</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>

<span class="co"># shortest flights by distance</span>
<span class="kw">arrange</span>(flights, distance)
<span class="co">#&gt; # A tibble: 336,776 × 19</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     7    27       NA            106        NA       NA</span>
<span class="co">#&gt; 2   2013     1     3     2127           2129        -2     2222</span>
<span class="co">#&gt; 3   2013     1     4     1240           1200        40     1333</span>
<span class="co">#&gt; 4   2013     1     4     1829           1615       134     1937</span>
<span class="co">#&gt; 5   2013     1     4     2128           2129        -1     2218</span>
<span class="co">#&gt; 6   2013     1     5     1155           1200        -5     1241</span>
<span class="co">#&gt; 7   2013     1     6     2125           2129        -4     2224</span>
<span class="co">#&gt; 8   2013     1     7     2124           2129        -5     2212</span>
<span class="co">#&gt; 9   2013     1     8     2127           2130        -3     2304</span>
<span class="co">#&gt; 10  2013     1     9     2126           2129        -3     2217</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></code></pre></div></li>
</ol>
</div>
<div id="exercises-9" class="section level2">
<h2>5.4.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Brainstorm as many ways as possible to select <code>dep_time</code>, <code>dep_delay</code>, <code>arr_time</code>, and <code>arr_delay</code> from <code>flights</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(flights, dep_time, dep_delay, arr_time, arr_delay)
<span class="co">#&gt; # A tibble: 336,776 × 4</span>
<span class="co">#&gt;    dep_time dep_delay arr_time arr_delay</span>
<span class="co">#&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1       517         2      830        11</span>
<span class="co">#&gt; 2       533         4      850        20</span>
<span class="co">#&gt; 3       542         2      923        33</span>
<span class="co">#&gt; 4       544        -1     1004       -18</span>
<span class="co">#&gt; 5       554        -6      812       -25</span>
<span class="co">#&gt; 6       554        -4      740        12</span>
<span class="co">#&gt; 7       555        -5      913        19</span>
<span class="co">#&gt; 8       557        -3      709       -14</span>
<span class="co">#&gt; 9       557        -3      838        -8</span>
<span class="co">#&gt; 10      558        -2      753         8</span>
<span class="co">#&gt; # ... with 336,766 more rows</span>
<span class="kw">select</span>(flights, <span class="kw">starts_with</span>(<span class="st">&quot;dep&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;arr&quot;</span>))
<span class="co">#&gt; # A tibble: 336,776 × 4</span>
<span class="co">#&gt;    dep_time dep_delay arr_time arr_delay</span>
<span class="co">#&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1       517         2      830        11</span>
<span class="co">#&gt; 2       533         4      850        20</span>
<span class="co">#&gt; 3       542         2      923        33</span>
<span class="co">#&gt; 4       544        -1     1004       -18</span>
<span class="co">#&gt; 5       554        -6      812       -25</span>
<span class="co">#&gt; 6       554        -4      740        12</span>
<span class="co">#&gt; 7       555        -5      913        19</span>
<span class="co">#&gt; 8       557        -3      709       -14</span>
<span class="co">#&gt; 9       557        -3      838        -8</span>
<span class="co">#&gt; 10      558        -2      753         8</span>
<span class="co">#&gt; # ... with 336,766 more rows</span>
<span class="kw">select</span>(flights, <span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>))
<span class="co">#&gt; # A tibble: 336,776 × 2</span>
<span class="co">#&gt;    dep_delay arr_delay</span>
<span class="co">#&gt;        &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1          2        11</span>
<span class="co">#&gt; 2          4        20</span>
<span class="co">#&gt; 3          2        33</span>
<span class="co">#&gt; 4         -1       -18</span>
<span class="co">#&gt; 5         -6       -25</span>
<span class="co">#&gt; 6         -4        12</span>
<span class="co">#&gt; 7         -5        19</span>
<span class="co">#&gt; 8         -3       -14</span>
<span class="co">#&gt; 9         -3        -8</span>
<span class="co">#&gt; 10        -2         8</span>
<span class="co">#&gt; # ... with 336,766 more rows</span>
<span class="kw">select</span>(flights, <span class="kw">contains</span>(<span class="st">&quot;delay&quot;</span>))
<span class="co">#&gt; # A tibble: 336,776 × 2</span>
<span class="co">#&gt;    dep_delay arr_delay</span>
<span class="co">#&gt;        &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1          2        11</span>
<span class="co">#&gt; 2          4        20</span>
<span class="co">#&gt; 3          2        33</span>
<span class="co">#&gt; 4         -1       -18</span>
<span class="co">#&gt; 5         -6       -25</span>
<span class="co">#&gt; 6         -4        12</span>
<span class="co">#&gt; 7         -5        19</span>
<span class="co">#&gt; 8         -3       -14</span>
<span class="co">#&gt; 9         -3        -8</span>
<span class="co">#&gt; 10        -2         8</span>
<span class="co">#&gt; # ... with 336,766 more rows</span></code></pre></div></li>
<li><p>What happens if you include the name of a variable multiple times in a <code>select()</code> call?</p>
<p>It is included only a single time in the new data frame.</p></li>
<li><p>What does the <code>one_of()</code> function do? Why might it be helpful in conjunction with this vector?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;dep_delay&quot;</span>, <span class="st">&quot;arr_delay&quot;</span>)</code></pre></div>
<p>It selects any variable which matches one of the strings in the vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(flights, <span class="kw">one_of</span>(vars))
<span class="co">#&gt; # A tibble: 336,776 × 5</span>
<span class="co">#&gt;     year month   day dep_delay arr_delay</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1   2013     1     1         2        11</span>
<span class="co">#&gt; 2   2013     1     1         4        20</span>
<span class="co">#&gt; 3   2013     1     1         2        33</span>
<span class="co">#&gt; 4   2013     1     1        -1       -18</span>
<span class="co">#&gt; 5   2013     1     1        -6       -25</span>
<span class="co">#&gt; 6   2013     1     1        -4        12</span>
<span class="co">#&gt; 7   2013     1     1        -5        19</span>
<span class="co">#&gt; 8   2013     1     1        -3       -14</span>
<span class="co">#&gt; 9   2013     1     1        -3        -8</span>
<span class="co">#&gt; 10  2013     1     1        -2         8</span>
<span class="co">#&gt; # ... with 336,766 more rows</span></code></pre></div></li>
<li><p>Does the result of running the following code surprise you? How do the select helpers deal with case by default? How can you change that default?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(flights, <span class="kw">contains</span>(<span class="st">&quot;TIME&quot;</span>))
<span class="co">#&gt; # A tibble: 336,776 × 6</span>
<span class="co">#&gt;    dep_time sched_dep_time arr_time sched_arr_time air_time</span>
<span class="co">#&gt;       &lt;int&gt;          &lt;int&gt;    &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1       517            515      830            819      227</span>
<span class="co">#&gt; 2       533            529      850            830      227</span>
<span class="co">#&gt; 3       542            540      923            850      160</span>
<span class="co">#&gt; 4       544            545     1004           1022      183</span>
<span class="co">#&gt; 5       554            600      812            837      116</span>
<span class="co">#&gt; 6       554            558      740            728      150</span>
<span class="co">#&gt; 7       555            600      913            854      158</span>
<span class="co">#&gt; 8       557            600      709            723       53</span>
<span class="co">#&gt; 9       557            600      838            846      140</span>
<span class="co">#&gt; 10      558            600      753            745      138</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 1 more variables: time_hour &lt;dttm&gt;</span></code></pre></div>
<p>By default the select helpers ignore case. To adhere to case, set <code>ignore.case = FALSE</code> in the helper function. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(flights, <span class="kw">contains</span>(<span class="st">&quot;TIME&quot;</span>, <span class="dt">ignore.case =</span> <span class="ot">FALSE</span>))
<span class="co">#&gt; # A tibble: 336,776 × 0</span></code></pre></div></li>
</ol>
</div>
<div id="exercises-10" class="section level2">
<h2>5.5.2 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Currently <code>dep_time</code> and <code>sched_dep_time</code> are convenient to look at, but hard to compute with because they’re not really continuous numbers. Convert them to a more convenient representation of number of minutes since midnight.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">transmute</span>(flights,
       <span class="dt">sched_dep_time =</span> (sched_dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span>) <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="op">+</span><span class="st"> </span>sched_dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>,
       <span class="dt">dep_time =</span> (dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span>) <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="op">+</span><span class="st"> </span>dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>)
<span class="co">#&gt; # A tibble: 336,776 × 2</span>
<span class="co">#&gt;    sched_dep_time dep_time</span>
<span class="co">#&gt;             &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1             315      317</span>
<span class="co">#&gt; 2             329      333</span>
<span class="co">#&gt; 3             340      342</span>
<span class="co">#&gt; 4             345      344</span>
<span class="co">#&gt; 5             360      354</span>
<span class="co">#&gt; 6             358      354</span>
<span class="co">#&gt; 7             360      355</span>
<span class="co">#&gt; 8             360      357</span>
<span class="co">#&gt; 9             360      357</span>
<span class="co">#&gt; 10            360      358</span>
<span class="co">#&gt; # ... with 336,766 more rows</span></code></pre></div></li>
<li><p>Compare <code>air_time</code> with <code>arr_time - dep_time</code>. What do you expect to see? What do you see? What do you need to do to fix it?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights2 &lt;-<span class="st"> </span><span class="kw">select</span>(flights, air_time, arr_time, dep_time)
<span class="kw">mutate</span>(flights2, <span class="dt">air_time_new =</span> arr_time <span class="op">-</span><span class="st"> </span>dep_time)
<span class="co">#&gt; # A tibble: 336,776 × 4</span>
<span class="co">#&gt;    air_time arr_time dep_time air_time_new</span>
<span class="co">#&gt;       &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;        &lt;int&gt;</span>
<span class="co">#&gt; 1       227      830      517          313</span>
<span class="co">#&gt; 2       227      850      533          317</span>
<span class="co">#&gt; 3       160      923      542          381</span>
<span class="co">#&gt; 4       183     1004      544          460</span>
<span class="co">#&gt; 5       116      812      554          258</span>
<span class="co">#&gt; 6       150      740      554          186</span>
<span class="co">#&gt; 7       158      913      555          358</span>
<span class="co">#&gt; 8        53      709      557          152</span>
<span class="co">#&gt; 9       140      838      557          281</span>
<span class="co">#&gt; 10      138      753      558          195</span>
<span class="co">#&gt; # ... with 336,766 more rows</span></code></pre></div>
<p>They are not the same because <code>dep_time</code> and <code>arr_time</code> are not measured in minutes, but are numerical representations of the time. We need to convert them to continuous numbers like above to make the correct calculation for <code>air_time</code>.</p></li>
<li><p>Compare <code>dep_time</code>, <code>sched_dep_time</code>, and <code>dep_delay</code>. How would you expect those three numbers to be related?</p>
<p><code>dep_time</code> should equal <code>sched_dep_time</code> <span class="math inline">\(+\)</span> <code>dep_delay</code> (after accounting for the fact that they are not stored continuously).</p></li>
<li><p>Find the 10 most delayed flights using a ranking function. How do you want to handle ties? Carefully read the documentation for <code>min_rank()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">delayed &lt;-<span class="st"> </span><span class="kw">mutate</span>(flights, <span class="dt">most_delayed =</span> <span class="kw">min_rank</span>(<span class="kw">desc</span>(arr_delay)))
<span class="kw">arrange</span>(delayed, most_delayed)
<span class="co">#&gt; # A tibble: 336,776 × 20</span>
<span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1   2013     1     9      641            900      1301     1242</span>
<span class="co">#&gt; 2   2013     6    15     1432           1935      1137     1607</span>
<span class="co">#&gt; 3   2013     1    10     1121           1635      1126     1239</span>
<span class="co">#&gt; 4   2013     9    20     1139           1845      1014     1457</span>
<span class="co">#&gt; 5   2013     7    22      845           1600      1005     1044</span>
<span class="co">#&gt; 6   2013     4    10     1100           1900       960     1342</span>
<span class="co">#&gt; 7   2013     3    17     2321            810       911      135</span>
<span class="co">#&gt; 8   2013     7    22     2257            759       898      121</span>
<span class="co">#&gt; 9   2013    12     5      756           1700       896     1058</span>
<span class="co">#&gt; 10  2013     5     3     1133           2055       878     1250</span>
<span class="co">#&gt; # ... with 336,766 more rows, and 13 more variables: sched_arr_time &lt;int&gt;,</span>
<span class="co">#&gt; #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,</span>
<span class="co">#&gt; #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,</span>
<span class="co">#&gt; #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, most_delayed &lt;int&gt;</span></code></pre></div>
<p>I used <code>min_rank()</code> which assigns ties to the lowest rank. See <a href="http://stats.stackexchange.com/questions/34008/how-does-ties-method-argument-of-rs-rank-function-work">here</a> for a detailed discussion of potential tie breaking methods.</p></li>
<li><p>What does <code>1:3 + 1:10</code> return? Why?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>
<span class="co">#&gt; Warning in 1:3 + 1:10: longer object length is not a multiple of shorter</span>
<span class="co">#&gt; object length</span>
<span class="co">#&gt;  [1]  2  4  6  5  7  9  8 10 12 11</span></code></pre></div>
<p>Because the two vectors are not the same length, R <strong>recycles</strong> the shorter one until each vector is the same length. Then R adds the first elements together, then the second elements, then the third, etc.</p></li>
<li><p>What trigonometric functions does R provide?</p>
<p><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Trig.html">Cosine, sine, tangent, arc-tangent, arc-sine, arc-tangent, and the two-argument arc-tangent.</a></p></li>
</ol>
</div>
<div id="exercises-11" class="section level2">
<h2>5.6.7 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Brainstorm at least 5 different ways to assess the typical delay characteristics of a group of flights. Consider the following scenarios:</p>
<ul>
<li><p>A flight is 15 minutes early 50% of the time, and 15 minutes late 50% of the time.</p></li>
<li><p>A flight is always 10 minutes late.</p></li>
<li><p>A flight is 30 minutes early 50% of the time, and 30 minutes late 50% of the time.</p></li>
<li><p>99% of the time a flight is on time. 1% of the time it’s 2 hours late.</p></li>
</ul>
<p>Which is more important: arrival delay or departure delay?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A flight is 15 minutes early 50% of the time, and 15 minutes late 50% of the time.</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(flight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">early_15_min =</span> <span class="kw">sum</span>(arr_delay <span class="op">&lt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">15</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
            <span class="dt">late_15_min =</span> <span class="kw">sum</span>(arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">15</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(early_15_min <span class="op">==</span><span class="st"> </span><span class="fl">0.5</span>,
         late_15_min <span class="op">==</span><span class="st"> </span><span class="fl">0.5</span>)
<span class="co">#&gt; # A tibble: 18 × 3</span>
<span class="co">#&gt;    flight early_15_min late_15_min</span>
<span class="co">#&gt;     &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1     107          0.5         0.5</span>
<span class="co">#&gt; 2    2072          0.5         0.5</span>
<span class="co">#&gt; 3    2366          0.5         0.5</span>
<span class="co">#&gt; 4    2500          0.5         0.5</span>
<span class="co">#&gt; 5    2552          0.5         0.5</span>
<span class="co">#&gt; 6    3495          0.5         0.5</span>
<span class="co">#&gt; 7    3518          0.5         0.5</span>
<span class="co">#&gt; 8    3544          0.5         0.5</span>
<span class="co">#&gt; 9    3651          0.5         0.5</span>
<span class="co">#&gt; 10   3705          0.5         0.5</span>
<span class="co">#&gt; 11   3916          0.5         0.5</span>
<span class="co">#&gt; 12   3951          0.5         0.5</span>
<span class="co">#&gt; 13   4273          0.5         0.5</span>
<span class="co">#&gt; 14   4313          0.5         0.5</span>
<span class="co">#&gt; 15   5297          0.5         0.5</span>
<span class="co">#&gt; 16   5322          0.5         0.5</span>
<span class="co">#&gt; 17   5388          0.5         0.5</span>
<span class="co">#&gt; 18   5505          0.5         0.5</span>

<span class="co"># A flight is always 10 minutes late.</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(flight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">late_10 =</span> <span class="kw">sum</span>(arr_delay <span class="op">==</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(late_<span class="dv">10</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
<span class="co">#&gt; # A tibble: 4 × 2</span>
<span class="co">#&gt;   flight late_10</span>
<span class="co">#&gt;    &lt;int&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   2254       1</span>
<span class="co">#&gt; 2   3656       1</span>
<span class="co">#&gt; 3   3880       1</span>
<span class="co">#&gt; 4   5854       1</span>

<span class="co"># A flight is 30 minutes early 50% of the time, and 30 minutes late 50% of the time.</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(flight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">early_30_min =</span> <span class="kw">sum</span>(arr_delay <span class="op">&lt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">30</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
            <span class="dt">late_30_min =</span> <span class="kw">sum</span>(arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(early_30_min <span class="op">==</span><span class="st"> </span><span class="fl">0.5</span>,
         late_30_min <span class="op">==</span><span class="st"> </span><span class="fl">0.5</span>)
<span class="co">#&gt; # A tibble: 3 × 3</span>
<span class="co">#&gt;   flight early_30_min late_30_min</span>
<span class="co">#&gt;    &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1   3651          0.5         0.5</span>
<span class="co">#&gt; 2   3916          0.5         0.5</span>
<span class="co">#&gt; 3   3951          0.5         0.5</span>

<span class="co"># 99% of the time a flight is on time. 1% of the time it&#39;s 2 hours late.</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(flight) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">on_time =</span> <span class="kw">sum</span>(arr_delay <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
            <span class="dt">late_2_hours =</span> <span class="kw">sum</span>(arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">120</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(on_time <span class="op">==</span><span class="st"> </span>.<span class="dv">99</span>,
         late_2_hours <span class="op">==</span><span class="st"> </span>.<span class="dv">01</span>)
<span class="co">#&gt; # A tibble: 0 × 3</span>
<span class="co">#&gt; # ... with 3 variables: flight &lt;int&gt;, on_time &lt;dbl&gt;, late_2_hours &lt;dbl&gt;</span></code></pre></div>
<p>Delay type importance depends on individual preference. If an individual hates waiting in the terminal for the flight to take off, then departure delay is more important. If the individual cares more about arriving at their destination on time (which I personally care more about), then arrival delay is most important.</p></li>
<li><p>Come up with another approach that will give you the same output as <code>not_cancelled %&gt;% count(dest)</code> and <code>not_cancelled %&gt;% count(tailnum, wt = distance)</code> (without using <code>count()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">not_cancelled &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(dep_delay), <span class="op">!</span><span class="kw">is.na</span>(arr_delay))

<span class="co"># original</span>
not_cancelled <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(dest)
<span class="co">#&gt; # A tibble: 104 × 2</span>
<span class="co">#&gt;     dest     n</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1    ABQ   254</span>
<span class="co">#&gt; 2    ACK   264</span>
<span class="co">#&gt; 3    ALB   418</span>
<span class="co">#&gt; 4    ANC     8</span>
<span class="co">#&gt; 5    ATL 16837</span>
<span class="co">#&gt; 6    AUS  2411</span>
<span class="co">#&gt; 7    AVL   261</span>
<span class="co">#&gt; 8    BDL   412</span>
<span class="co">#&gt; 9    BGR   358</span>
<span class="co">#&gt; 10   BHM   269</span>
<span class="co">#&gt; # ... with 94 more rows</span>

<span class="co"># new</span>
not_cancelled <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(dest) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>())
<span class="co">#&gt; # A tibble: 104 × 2</span>
<span class="co">#&gt;     dest     n</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1    ABQ   254</span>
<span class="co">#&gt; 2    ACK   264</span>
<span class="co">#&gt; 3    ALB   418</span>
<span class="co">#&gt; 4    ANC     8</span>
<span class="co">#&gt; 5    ATL 16837</span>
<span class="co">#&gt; 6    AUS  2411</span>
<span class="co">#&gt; 7    AVL   261</span>
<span class="co">#&gt; 8    BDL   412</span>
<span class="co">#&gt; 9    BGR   358</span>
<span class="co">#&gt; 10   BHM   269</span>
<span class="co">#&gt; # ... with 94 more rows</span>

<span class="co"># original</span>
not_cancelled <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(tailnum, <span class="dt">wt =</span> distance)
<span class="co">#&gt; # A tibble: 4,037 × 2</span>
<span class="co">#&gt;    tailnum      n</span>
<span class="co">#&gt;      &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1   D942DN   3418</span>
<span class="co">#&gt; 2   N0EGMQ 239143</span>
<span class="co">#&gt; 3   N10156 109664</span>
<span class="co">#&gt; 4   N102UW  25722</span>
<span class="co">#&gt; 5   N103US  24619</span>
<span class="co">#&gt; 6   N104UW  24616</span>
<span class="co">#&gt; 7   N10575 139903</span>
<span class="co">#&gt; 8   N105UW  23618</span>
<span class="co">#&gt; 9   N107US  21677</span>
<span class="co">#&gt; 10  N108UW  32070</span>
<span class="co">#&gt; # ... with 4,027 more rows</span>

<span class="co"># new</span>
not_cancelled <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(tailnum) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">sum</span>(distance, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="co">#&gt; # A tibble: 4,037 × 2</span>
<span class="co">#&gt;    tailnum      n</span>
<span class="co">#&gt;      &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1   D942DN   3418</span>
<span class="co">#&gt; 2   N0EGMQ 239143</span>
<span class="co">#&gt; 3   N10156 109664</span>
<span class="co">#&gt; 4   N102UW  25722</span>
<span class="co">#&gt; 5   N103US  24619</span>
<span class="co">#&gt; 6   N104UW  24616</span>
<span class="co">#&gt; 7   N10575 139903</span>
<span class="co">#&gt; 8   N105UW  23618</span>
<span class="co">#&gt; 9   N107US  21677</span>
<span class="co">#&gt; 10  N108UW  32070</span>
<span class="co">#&gt; # ... with 4,027 more rows</span></code></pre></div></li>
<li><p>Our definition of cancelled flights (<code>is.na(dep_delay) | is.na(arr_delay)</code> ) is slightly suboptimal. Why? Which is the most important column?</p>
<p>There are no flights which arrived but did not depart, so we can just use <code>!is.na(dep_delay)</code>.</p></li>
<li><p>Look at the number of cancelled flights per day. Is there a pattern? Is the proportion of cancelled flights related to the average delay?</p>
<p>**NOTE: I assume when the question refers to “per day”, I am only grouping by <code>day</code>. Alternatively this could mean to group by calendar day, which would require grouping by <code>year</code>, <code>month</code>, and <code>day</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(dep_delay)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(day)
<span class="co">#&gt; # A tibble: 31 × 2</span>
<span class="co">#&gt;      day     n</span>
<span class="co">#&gt;    &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1      1   246</span>
<span class="co">#&gt; 2      2   250</span>
<span class="co">#&gt; 3      3   109</span>
<span class="co">#&gt; 4      4    82</span>
<span class="co">#&gt; 5      5   226</span>
<span class="co">#&gt; 6      6   296</span>
<span class="co">#&gt; 7      7   318</span>
<span class="co">#&gt; 8      8   921</span>
<span class="co">#&gt; 9      9   593</span>
<span class="co">#&gt; 10    10   535</span>
<span class="co">#&gt; # ... with 21 more rows</span>

flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(day) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prop_canceled =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(dep_delay)) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
            <span class="dt">avg_delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="co">#&gt; # A tibble: 31 × 3</span>
<span class="co">#&gt;      day prop_canceled avg_delay</span>
<span class="co">#&gt;    &lt;int&gt;         &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1       0.02229     14.17</span>
<span class="co">#&gt; 2      2       0.02313     14.12</span>
<span class="co">#&gt; 3      3       0.00972     10.81</span>
<span class="co">#&gt; 4      4       0.00741      5.79</span>
<span class="co">#&gt; 5      5       0.02081      7.82</span>
<span class="co">#&gt; 6      6       0.02677      6.99</span>
<span class="co">#&gt; 7      7       0.02895     14.34</span>
<span class="co">#&gt; 8      8       0.08171     21.76</span>
<span class="co">#&gt; 9      9       0.05462     14.64</span>
<span class="co">#&gt; 10    10       0.04765     18.30</span>
<span class="co">#&gt; # ... with 21 more rows</span></code></pre></div></li>
<li><p>Which carrier has the worst delays? Challenge: can you disentangle the effects of bad airports vs. bad carriers? Why/why not? (Hint: think about <code>flights %&gt;% group_by(carrier, dest) %&gt;% summarise(n())</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># worst delays</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(carrier) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_delay))
<span class="co">#&gt; # A tibble: 16 × 2</span>
<span class="co">#&gt;    carrier mean_delay</span>
<span class="co">#&gt;      &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1       F9     21.921</span>
<span class="co">#&gt; 2       FL     20.116</span>
<span class="co">#&gt; 3       EV     15.796</span>
<span class="co">#&gt; 4       YV     15.557</span>
<span class="co">#&gt; 5       OO     11.931</span>
<span class="co">#&gt; 6       MQ     10.775</span>
<span class="co">#&gt; 7       WN      9.649</span>
<span class="co">#&gt; 8       B6      9.458</span>
<span class="co">#&gt; 9       9E      7.380</span>
<span class="co">#&gt; 10      UA      3.558</span>
<span class="co">#&gt; 11      US      2.130</span>
<span class="co">#&gt; 12      VX      1.764</span>
<span class="co">#&gt; 13      DL      1.644</span>
<span class="co">#&gt; 14      AA      0.364</span>
<span class="co">#&gt; 15      HA     -6.915</span>
<span class="co">#&gt; 16      AS     -9.931</span>

<span class="co"># challenge: bad airports vs. bad carriers</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(carrier, dest) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(carrier) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_delay_mad =</span> <span class="kw">mad</span>(mean_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_delay_mad))
<span class="co">#&gt; # A tibble: 16 × 2</span>
<span class="co">#&gt;    carrier mean_delay_mad</span>
<span class="co">#&gt;      &lt;chr&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1       VX          12.39</span>
<span class="co">#&gt; 2       OO          10.52</span>
<span class="co">#&gt; 3       YV           8.97</span>
<span class="co">#&gt; 4       9E           8.20</span>
<span class="co">#&gt; 5       EV           7.09</span>
<span class="co">#&gt; 6       DL           7.00</span>
<span class="co">#&gt; 7       UA           5.04</span>
<span class="co">#&gt; 8       US           5.03</span>
<span class="co">#&gt; 9       B6           5.00</span>
<span class="co">#&gt; 10      WN           4.51</span>
<span class="co">#&gt; 11      AA           3.31</span>
<span class="co">#&gt; 12      MQ           2.88</span>
<span class="co">#&gt; 13      FL           1.55</span>
<span class="co">#&gt; 14      AS           0.00</span>
<span class="co">#&gt; 15      F9           0.00</span>
<span class="co">#&gt; 16      HA           0.00</span></code></pre></div>
<p>For the challenge, I calculated the median absolute deviation of average arrival delay by carrier and destination. Higher values indicate a larger spread in the average delays across destinations, meaning these carriers experienced more variation in average delays - for some destinations these carriers experienced longer delays, whereas some destinations arrivals were closer to on time. Lower values mean the carrier experienced similar delays across destinations. <strong>It does not mean these carriers were on time.</strong> It just means they were more consistent. Comparing this table to the first table of average arrival delays could disentangle the effect of bad carriers vs. bad airports.</p></li>
<li><p>For each plane, count the number of flights before the first delay of greater than 1 hour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(tailnum) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">row_num =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">first_hour_delay =</span> <span class="kw">first</span>(row_num) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)
<span class="co">#&gt; # A tibble: 3,371 × 2</span>
<span class="co">#&gt;    tailnum first_hour_delay</span>
<span class="co">#&gt;      &lt;chr&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1   D942DN                0</span>
<span class="co">#&gt; 2   N0EGMQ                0</span>
<span class="co">#&gt; 3   N10156                9</span>
<span class="co">#&gt; 4   N102UW               33</span>
<span class="co">#&gt; 5   N104UW                6</span>
<span class="co">#&gt; 6   N10575                0</span>
<span class="co">#&gt; 7   N105UW               34</span>
<span class="co">#&gt; 8   N107US               29</span>
<span class="co">#&gt; 9   N108UW                9</span>
<span class="co">#&gt; 10  N109UW               15</span>
<span class="co">#&gt; # ... with 3,361 more rows</span></code></pre></div>
<p>This uses a grouped summary operation. First I group by plane (<code>tailnum</code>), then I create a variable that defines the row number within each plane. I then filter the data to only include flights with delays longer than an hour, and use <code>summarize()</code> in conjunction with <code>first()</code> to find for each plane the <code>row_num</code> of the first flight with an 1+ hour delay. I subtract 1 from that value to count the number of flights <em>before the first delay</em>, rather than including the first flight with the hour or more delay.</p></li>
<li><p>What does the <code>sort</code> argument to <code>count()</code> do. When might you use it?</p>
<p>The <code>sort</code> argument will sort the results of <code>count()</code> in descending order of <code>n</code>. You might use this if you plan to <code>arrange()</code> the results after completing the count. This saves you a line of code.</p></li>
</ol>
</div>
<div id="exercises-12" class="section level2">
<h2>5.7.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Refer back to the table of useful mutate and filtering functions. Describe how each operation changes when you combine it with grouping.</p></li>
<li><p>Which plane (<code>tailnum</code>) has the worst on-time record?</p>
<p>Here I define “on-time” as arriving within 30 minutes of the scheduled arrival time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(tailnum) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">prop_on_time =</span> <span class="kw">sum</span>(arr_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
            <span class="dt">mean_arr_delay =</span> <span class="kw">mean</span>(arr_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">flights =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(prop_on_time, <span class="kw">desc</span>(mean_arr_delay))
<span class="co">#&gt; # A tibble: 4,044 × 4</span>
<span class="co">#&gt;    tailnum prop_on_time mean_arr_delay flights</span>
<span class="co">#&gt;      &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1   N844MH            0            320       1</span>
<span class="co">#&gt; 2   N911DA            0            294       1</span>
<span class="co">#&gt; 3   N922EV            0            276       1</span>
<span class="co">#&gt; 4   N587NW            0            264       1</span>
<span class="co">#&gt; 5   N851NW            0            219       1</span>
<span class="co">#&gt; 6   N928DN            0            201       1</span>
<span class="co">#&gt; 7   N7715E            0            188       1</span>
<span class="co">#&gt; 8   N654UA            0            185       1</span>
<span class="co">#&gt; 9   N427SW            0            157       1</span>
<span class="co">#&gt; 10  N136DL            0            146       1</span>
<span class="co">#&gt; # ... with 4,034 more rows</span></code></pre></div></li>
<li><p>What time of day should you fly if you want to avoid delays as much as possible?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(hour) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">arr_delay =</span> <span class="kw">sum</span>(arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hour, <span class="dt">y =</span> arr_delay)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-63-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Avoid flying in the evening to minimize your arrival delay.</p></li>
<li><p>For each destination, compute the total minutes of delay. For each, flight, compute the proportion of the total delay for its destination.</p></li>
<li><p>Delays are typically temporally correlated: even once the problem that caused the initial delay has been resolved, later flights are delayed to allow earlier flights to leave. Using <code>lag()</code> explore how the delay of a flight is related to the delay of the immediately preceding flight.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(origin) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(year, month, day, hour, minute) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prev_dep_delay =</span> <span class="kw">lag</span>(dep_delay)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prev_dep_delay, <span class="dt">y =</span> dep_delay)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>()
<span class="co">#&gt; `geom_smooth()` using method = &#39;gam&#39;</span>
<span class="co">#&gt; Warning: Removed 14383 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 14383 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-64-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Look at each destination. Can you find flights that are suspiciously fast? (i.e. flights that represent a potential data entry error). Compute the air time a flight relative to the shortest flight to that destination. Which flights were most delayed in the air?</p></li>
<li><p>Find all destinations that are flown by at least two carriers. Use that information to rank the carriers.</p></li>
</ol>
</div>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>7 Exploratory Data Analysis</h1>
<div id="exercises-13" class="section level2">
<h2>7.3.4 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Explore the distribution of each of the <code>x</code>, <code>y</code>, and <code>z</code> variables in <code>diamonds</code>. What do you learn? Think about a diamond and how you might decide which dimension is the length, width, and depth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-65-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-65-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(z)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-65-3.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Explore the distribution of <code>price</code>. Do you discover anything unusual or surprising? (Hint: Carefully think about the <code>binwidth</code> and make sure you try a wide range of values.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># default binwidth</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-66-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># binwidth = 100</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">100</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20000</span>, <span class="dt">by =</span> <span class="dv">1000</span>))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-66-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>There are far fewer diamonds priced at $1500 compared to other price points. This is not apparent using the default number of bins.</p></li>
<li><p>How many diamonds are 0.99 carat? How many are 1 carat? What do you think is the cause of the difference?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> .<span class="dv">01</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">97</span>, <span class="fl">1.03</span>))</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-67-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Around 1500 diamonds are <span class="math inline">\(1.00\)</span> carat, compared to around 30 or so diamonds at <span class="math inline">\(.99\)</span> carat. This could occur because prospective buyers of diamonds, if they are already willing to buy a <span class="math inline">\(.99\)</span> carat diamond will decide it is more aesthetically pleasing to say they bought a <span class="math inline">\(1\)</span> carat diamond so there is less demand for <span class="math inline">\(.99\)</span> carat diamonds.</p></li>
<li><p>Compare and contrast <code>coord_cartesian()</code> vs <code>xlim()</code> or <code>ylim()</code> when zooming in on a histogram. What happens if you leave <code>binwidth</code> unset? What happens if you try and zoom so only half a bar shows?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># full plot</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>()
<span class="co">#&gt; `geom_smooth()` using method = &#39;gam&#39;</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-68-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># xlim</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">1</span>, <span class="dv">3</span>)
<span class="co">#&gt; `geom_smooth()` using method = &#39;gam&#39;</span>
<span class="co">#&gt; Warning: Removed 34912 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 34912 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-68-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># coord_cartesian</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))
<span class="co">#&gt; `geom_smooth()` using method = &#39;gam&#39;</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-68-3.png" width="70%" style="display: block; margin: auto;" /></p>
<p>By using <code>xlim()</code> or <code>ylim()</code>, you remove all observations which exceed these values so they are not used to generate the plot. By using <code>coord_cartesian()</code>, those values are used to generate the plot and are merely cut off when zooming in. Note the change in the smoothing line in the <code>xlim()</code> example because it doesn’t have all the data points to calculate the line.</p></li>
</ol>
</div>
<div id="exercises-14" class="section level2">
<h2>7.4.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>What happens to missing values in a histogram? What happens to missing values in a bar chart? Why is there a difference?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(flights, <span class="kw">aes</span>(dep_delay)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co">#&gt; Warning: Removed 8255 rows containing non-finite values (stat_bin).</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-69-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># change AA to NA</span>
flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">carrier =</span> <span class="kw">ifelse</span>(carrier <span class="op">==</span><span class="st"> &quot;AA&quot;</span>, <span class="ot">NA</span>, carrier)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(carrier)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-69-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Histograms omit missing values, whereas bar charts draw them as a separate category. For continuous variables, like in a histogram, there is no meaningful location to draw missing values. On the far left? Far right? Middle? But for bar charts, which are used for categorical variables, you could draw them as a distinct bar; by default it can be located anywhere on the chart (conventionally it is drawn on the right side). You can override this default to completely remove missing values from the chart if you prefer.</p></li>
<li><p>What does <code>na.rm = TRUE</code> do in <code>mean()</code> and <code>sum()</code>?</p>
<p>It strips missing values before computing the statistic.</p></li>
</ol>
</div>
<div id="exercises-15" class="section level2">
<h2>7.5.1.1 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Use what you’ve learned to improve the visualisation of the departure times of cancelled vs. non-cancelled flights.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># original chart</span>
flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">cancelled =</span> <span class="kw">is.na</span>(dep_time),
    <span class="dt">sched_hour =</span> sched_dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span>,
    <span class="dt">sched_min =</span> sched_dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>,
    <span class="dt">sched_dep_time =</span> sched_hour <span class="op">+</span><span class="st"> </span>sched_min <span class="op">/</span><span class="st"> </span><span class="dv">60</span>
    ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(sched_dep_time)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_freqpoly</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> cancelled), <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-70-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># revised chart</span>
flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">cancelled =</span> <span class="kw">is.na</span>(dep_time),
    <span class="dt">sched_hour =</span> sched_dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span>,
    <span class="dt">sched_min =</span> sched_dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>,
    <span class="dt">sched_dep_time =</span> sched_hour <span class="op">+</span><span class="st"> </span>sched_min <span class="op">/</span><span class="st"> </span><span class="dv">60</span>
    ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sched_dep_time, <span class="dt">y =</span> ..density.., <span class="dt">color =</span> cancelled)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-70-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>What variable in the diamonds dataset is most important for predicting the price of a diamond? How is that variable correlated with cut? Why does the combination of those two relationships lead to lower quality diamonds being more expensive?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>()
<span class="co">#&gt; `geom_smooth()` using method = &#39;gam&#39;</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-71-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Carat size is the most important predictor of price.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(cut, carat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-72-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This boxplot visualizes the relationship between cut and carat. On average, fair and good cut diamonds are larger than premium and ideal cuts. If carat size is the more dominant predictor of price, then some larger good cut diamonds will be more expensive than smaller ideal cut diamonds.</p></li>
<li><p>Install the <code>ggstance</code> package, and create a horizontal boxplot. How does this compare to using <code>coord_flip()</code>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ggstance&quot;</span>)</code></pre></div>
<p>To create a horizontal layer in <code>ggplot2</code> with <code>coord_flip()</code>, you have to supply aesthetics as if they were to be drawn vertically:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(cut, carat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-74-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In <code>ggstance</code>, you supply aesthetics in their natural order:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggstance)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: &#39;ggstance&#39;</span>
<span class="co">#&gt; The following objects are masked from &#39;package:ggplot2&#39;:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     geom_errorbarh, GeomErrorbarh</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(carat, cut)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxploth</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-75-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>One problem with boxplots is that they were developed in an era of much smaller datasets and tend to display a prohibitively large number of “outlying values”. One approach to remedy this problem is the letter value plot. Install the <code>lvplot</code> package, and try using <code>geom_lv()</code> to display the distribution of price vs cut. What do you learn? How do you interpret the plots?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;hadley/lvplot&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lvplot)

<span class="co"># with boxplot</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(cut, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-77-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># with lvplot</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(cut, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_lv</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-77-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Compare and contrast <code>geom_violin()</code> with a facetted <code>geom_histogram()</code>, or a coloured <code>geom_freqpoly()</code>. What are the pros and cons of each method?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># geom_violin</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(cut, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-78-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># faceted geom_histogram</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>cut)
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-78-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># colored geom_freqpoly</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(price, <span class="dt">color =</span> cut)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_freqpoly</span>()
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-78-3.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>If you have a small dataset, it’s sometimes useful to use <code>geom_jitter()</code> to see the relationship between a continuous and categorical variable. The <code>ggbeeswarm</code> package provides a number of methods similar to <code>geom_jitter()</code>. List them and briefly describe what each one does.</p></li>
</ol>
</div>
</div>
<div id="tibbles" class="section level1">
<h1>10 Tibbles</h1>
<div id="exercises-16" class="section level2">
<h2>10.5 Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>How can you tell if an object is a tibble? (Hint: try printing <code>mtcars</code>, which is a regular data frame).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># data frame</span>
<span class="kw">print</span>(mtcars)
<span class="co">#&gt;                      mpg cyl  disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4           21.0   6 160.0 110 3.90 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.88 17.0  0  1    4    4</span>
<span class="co">#&gt; Datsun 710          22.8   4 108.0  93 3.85 2.32 18.6  1  1    4    1</span>
<span class="co">#&gt; Hornet 4 Drive      21.4   6 258.0 110 3.08 3.21 19.4  1  0    3    1</span>
<span class="co">#&gt; Hornet Sportabout   18.7   8 360.0 175 3.15 3.44 17.0  0  0    3    2</span>
<span class="co">#&gt; Valiant             18.1   6 225.0 105 2.76 3.46 20.2  1  0    3    1</span>
<span class="co">#&gt; Duster 360          14.3   8 360.0 245 3.21 3.57 15.8  0  0    3    4</span>
<span class="co">#&gt; Merc 240D           24.4   4 146.7  62 3.69 3.19 20.0  1  0    4    2</span>
<span class="co">#&gt; Merc 230            22.8   4 140.8  95 3.92 3.15 22.9  1  0    4    2</span>
<span class="co">#&gt; Merc 280            19.2   6 167.6 123 3.92 3.44 18.3  1  0    4    4</span>
<span class="co">#&gt; Merc 280C           17.8   6 167.6 123 3.92 3.44 18.9  1  0    4    4</span>
<span class="co">#&gt; Merc 450SE          16.4   8 275.8 180 3.07 4.07 17.4  0  0    3    3</span>
<span class="co">#&gt; Merc 450SL          17.3   8 275.8 180 3.07 3.73 17.6  0  0    3    3</span>
<span class="co">#&gt; Merc 450SLC         15.2   8 275.8 180 3.07 3.78 18.0  0  0    3    3</span>
<span class="co">#&gt; Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.25 18.0  0  0    3    4</span>
<span class="co">#&gt; Lincoln Continental 10.4   8 460.0 215 3.00 5.42 17.8  0  0    3    4</span>
<span class="co">#&gt; Chrysler Imperial   14.7   8 440.0 230 3.23 5.34 17.4  0  0    3    4</span>
<span class="co">#&gt; Fiat 128            32.4   4  78.7  66 4.08 2.20 19.5  1  1    4    1</span>
<span class="co">#&gt; Honda Civic         30.4   4  75.7  52 4.93 1.61 18.5  1  1    4    2</span>
<span class="co">#&gt; Toyota Corolla      33.9   4  71.1  65 4.22 1.83 19.9  1  1    4    1</span>
<span class="co">#&gt; Toyota Corona       21.5   4 120.1  97 3.70 2.46 20.0  1  0    3    1</span>
<span class="co">#&gt; Dodge Challenger    15.5   8 318.0 150 2.76 3.52 16.9  0  0    3    2</span>
<span class="co">#&gt; AMC Javelin         15.2   8 304.0 150 3.15 3.44 17.3  0  0    3    2</span>
<span class="co">#&gt; Camaro Z28          13.3   8 350.0 245 3.73 3.84 15.4  0  0    3    4</span>
<span class="co">#&gt; Pontiac Firebird    19.2   8 400.0 175 3.08 3.85 17.1  0  0    3    2</span>
<span class="co">#&gt; Fiat X1-9           27.3   4  79.0  66 4.08 1.94 18.9  1  1    4    1</span>
<span class="co">#&gt; Porsche 914-2       26.0   4 120.3  91 4.43 2.14 16.7  0  1    5    2</span>
<span class="co">#&gt; Lotus Europa        30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span>
<span class="co">#&gt; Ford Pantera L      15.8   8 351.0 264 4.22 3.17 14.5  0  1    5    4</span>
<span class="co">#&gt; Ferrari Dino        19.7   6 145.0 175 3.62 2.77 15.5  0  1    5    6</span>
<span class="co">#&gt; Maserati Bora       15.0   8 301.0 335 3.54 3.57 14.6  0  1    5    8</span>
<span class="co">#&gt; Volvo 142E          21.4   4 121.0 109 4.11 2.78 18.6  1  1    4    2</span>

<span class="co"># tibble</span>
<span class="kw">print</span>(<span class="kw">as_tibble</span>(mtcars))
<span class="co">#&gt; # A tibble: 32 × 11</span>
<span class="co">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span>
<span class="co">#&gt; *  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   21.0     6   160   110  3.90  2.62  16.5     0     1     4     4</span>
<span class="co">#&gt; 2   21.0     6   160   110  3.90  2.88  17.0     0     1     4     4</span>
<span class="co">#&gt; 3   22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span>
<span class="co">#&gt; 4   21.4     6   258   110  3.08  3.21  19.4     1     0     3     1</span>
<span class="co">#&gt; 5   18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</span>
<span class="co">#&gt; 6   18.1     6   225   105  2.76  3.46  20.2     1     0     3     1</span>
<span class="co">#&gt; 7   14.3     8   360   245  3.21  3.57  15.8     0     0     3     4</span>
<span class="co">#&gt; 8   24.4     4   147    62  3.69  3.19  20.0     1     0     4     2</span>
<span class="co">#&gt; 9   22.8     4   141    95  3.92  3.15  22.9     1     0     4     2</span>
<span class="co">#&gt; 10  19.2     6   168   123  3.92  3.44  18.3     1     0     4     4</span>
<span class="co">#&gt; # ... with 22 more rows</span></code></pre></div>
<p>A data frame will print the entire contents. A tibble will only print (by default) the first 10 rows and as many columns as will fit in the console.</p></li>
<li><p>Compare and contrast the following operations on a <code>data.frame</code> and equivalent tibble. What is different? Why might the default data frame behaviours cause you frustration?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># on a data frame</span>
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">abc =</span> <span class="dv">1</span>, <span class="dt">xyz =</span> <span class="st">&quot;a&quot;</span>)
df<span class="op">$</span>x
<span class="co">#&gt; [1] a</span>
<span class="co">#&gt; Levels: a</span>
df[, <span class="st">&quot;xyz&quot;</span>]
<span class="co">#&gt; [1] a</span>
<span class="co">#&gt; Levels: a</span>
df[, <span class="kw">c</span>(<span class="st">&quot;abc&quot;</span>, <span class="st">&quot;xyz&quot;</span>)]
<span class="co">#&gt;   abc xyz</span>
<span class="co">#&gt; 1   1   a</span>

<span class="co"># on a tibble</span>
df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">abc =</span> <span class="dv">1</span>, <span class="dt">xyz =</span> <span class="st">&quot;a&quot;</span>)
df<span class="op">$</span>x
<span class="co">#&gt; Warning: Unknown column &#39;x&#39;</span>
<span class="co">#&gt; NULL</span>
df[, <span class="st">&quot;xyz&quot;</span>]
<span class="co">#&gt; # A tibble: 1 × 1</span>
<span class="co">#&gt;     xyz</span>
<span class="co">#&gt;   &lt;chr&gt;</span>
<span class="co">#&gt; 1     a</span>
df[, <span class="kw">c</span>(<span class="st">&quot;abc&quot;</span>, <span class="st">&quot;xyz&quot;</span>)]
<span class="co">#&gt; # A tibble: 1 × 2</span>
<span class="co">#&gt;     abc   xyz</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1     a</span></code></pre></div>
<ul>
<li>Tibbles never do partial matching; data frames do.</li>
<li><p>Subsetting tibbles using <code>[[</code> will always return a tibble; subsetting data frames using <code>[[</code> can potentially return a vector.</p>
<div class="figure">
<img src="images/gump.jpg" />

</div></li>
</ul></li>
<li><p>If you have the name of a variable stored in an object, e.g. <code>var &lt;- &quot;mpg&quot;</code>, how can you extract the reference variable from a tibble?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">var &lt;-<span class="st"> &quot;hwy&quot;</span>
mpg[[var]]
<span class="co">#&gt;   [1] 29 29 31 30 26 26 27 26 25 28 27 25 25 25 25 24 25 23 20 15 20 17 17</span>
<span class="co">#&gt;  [24] 26 23 26 25 24 19 14 15 17 27 30 26 29 26 24 24 22 22 24 24 17 22 21</span>
<span class="co">#&gt;  [47] 23 23 19 18 17 17 19 19 12 17 15 17 17 12 17 16 18 15 16 12 17 17 16</span>
<span class="co">#&gt;  [70] 12 15 16 17 15 17 17 18 17 19 17 19 19 17 17 17 16 16 17 15 17 26 25</span>
<span class="co">#&gt;  [93] 26 24 21 22 23 22 20 33 32 32 29 32 34 36 36 29 26 27 30 31 26 26 28</span>
<span class="co">#&gt; [116] 26 29 28 27 24 24 24 22 19 20 17 12 19 18 14 15 18 18 15 17 16 18 17</span>
<span class="co">#&gt; [139] 19 19 17 29 27 31 32 27 26 26 25 25 17 17 20 18 26 26 27 28 25 25 24</span>
<span class="co">#&gt; [162] 27 25 26 23 26 26 26 26 25 27 25 27 20 20 19 17 20 17 29 27 31 31 26</span>
<span class="co">#&gt; [185] 26 28 27 29 31 31 26 26 27 30 33 35 37 35 15 18 20 20 22 17 19 18 20</span>
<span class="co">#&gt; [208] 29 26 29 29 24 44 29 26 29 29 29 29 23 24 44 41 29 26 28 29 29 29 28</span>
<span class="co">#&gt; [231] 29 26 26 26</span></code></pre></div></li>
<li><p>Practice referring to non-syntactic names in the following data frame by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">annoying &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,
  <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">1</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(<span class="st">`</span><span class="dt">1</span><span class="st">`</span>))
)</code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Extracting the variable called <code>1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">annoying<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></code></pre></div></li>
<li><p>Plotting a scatterplot of <code>1</code> vs <code>2</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(annoying, <span class="kw">aes</span>(<span class="st">`</span><span class="dt">1</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="r4ds_solutions_files/figure-html/unnamed-chunk-84-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Creating a new column called <code>3</code> which is <code>2</code> divided by <code>1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(annoying &lt;-<span class="st"> </span><span class="kw">mutate</span>(annoying, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">2</span><span class="st">`</span> <span class="op">/</span><span class="st"> `</span><span class="dt">1</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 10 × 3</span>
<span class="co">#&gt;      `1`   `2`   `3`</span>
<span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1  3.18  3.18</span>
<span class="co">#&gt; 2      2  4.64  2.32</span>
<span class="co">#&gt; 3      3  5.37  1.79</span>
<span class="co">#&gt; 4      4  7.19  1.80</span>
<span class="co">#&gt; 5      5  9.14  1.83</span>
<span class="co">#&gt; 6      6  9.83  1.64</span>
<span class="co">#&gt; 7      7 12.62  1.80</span>
<span class="co">#&gt; 8      8 15.51  1.94</span>
<span class="co">#&gt; 9      9 17.42  1.94</span>
<span class="co">#&gt; 10    10 19.83  1.98</span></code></pre></div></li>
<li><p>Renaming the columns to <code>one</code>, <code>two</code> and <code>three</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rename</span>(annoying,
       <span class="dt">one =</span> <span class="st">`</span><span class="dt">1</span><span class="st">`</span>,
       <span class="dt">two =</span> <span class="st">`</span><span class="dt">2</span><span class="st">`</span>,
       <span class="dt">three =</span> <span class="st">`</span><span class="dt">3</span><span class="st">`</span>)
<span class="co">#&gt; # A tibble: 10 × 3</span>
<span class="co">#&gt;      one   two three</span>
<span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1  3.18  3.18</span>
<span class="co">#&gt; 2      2  4.64  2.32</span>
<span class="co">#&gt; 3      3  5.37  1.79</span>
<span class="co">#&gt; 4      4  7.19  1.80</span>
<span class="co">#&gt; 5      5  9.14  1.83</span>
<span class="co">#&gt; 6      6  9.83  1.64</span>
<span class="co">#&gt; 7      7 12.62  1.80</span>
<span class="co">#&gt; 8      8 15.51  1.94</span>
<span class="co">#&gt; 9      9 17.42  1.94</span>
<span class="co">#&gt; 10    10 19.83  1.98</span></code></pre></div></li>
</ol></li>
<li><p>What does <code>tibble::enframe()</code> do? When might you use it?</p>
<p><code>enframe()</code> is a helper function that converts named atomic vectors or lists to two-column data frames. You might use it if you have data stored in a named vector and you want to add it to a data frame and preserve both the name attribute and the actual value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">enframe</span>(<span class="kw">c</span>(<span class="dt">a =</span> <span class="dv">5</span>, <span class="dt">b =</span> <span class="dv">7</span>))
<span class="co">#&gt; # A tibble: 2 × 2</span>
<span class="co">#&gt;    name value</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     a     5</span>
<span class="co">#&gt; 2     b     7</span></code></pre></div></li>
<li><p>What option controls how many additional column names are printed at the footer of a tibble?</p>
<p><code>getOption(&quot;tibble.max_extra_cols&quot;)</code></p></li>
</ol>
</div>
</div>
<div id="session-info" class="section level1 toc-ignore">
<h1>Session Info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">session_info</span>()
<span class="co">#&gt; Session info -------------------------------------------------------------</span>
<span class="co">#&gt;  setting  value                       </span>
<span class="co">#&gt;  version  R version 3.4.1 (2017-06-30)</span>
<span class="co">#&gt;  system   x86_64, darwin15.6.0        </span>
<span class="co">#&gt;  ui       X11                         </span>
<span class="co">#&gt;  language (EN)                        </span>
<span class="co">#&gt;  collate  en_US.UTF-8                 </span>
<span class="co">#&gt;  tz       America/Chicago             </span>
<span class="co">#&gt;  date     2017-08-01</span>
<span class="co">#&gt; Packages -----------------------------------------------------------------</span>
<span class="co">#&gt;  package      * version    date       source                              </span>
<span class="co">#&gt;  assertthat     0.2.0      2017-04-11 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  backports      1.1.0      2017-05-22 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  base         * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  base64enc      0.1-3      2015-07-28 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  bindr          0.1        2016-11-13 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  bindrcpp     * 0.2        2017-06-17 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  bit            1.1-12     2014-04-09 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  bit64          0.9-7      2017-05-08 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  blob           1.1.0      2017-06-17 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  boxes          0.0.0.9000 2017-07-19 Github (r-pkgs/boxes@03098dc)       </span>
<span class="co">#&gt;  broom        * 0.4.2      2017-02-13 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  car          * 2.1-5      2017-07-04 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  caret        * 6.0-76     2017-04-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  cellranger     1.1.0      2016-07-27 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  class          7.3-14     2015-08-30 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  clisymbols     1.2.0      2017-05-21 cran (@1.2.0)                       </span>
<span class="co">#&gt;  codetools      0.2-15     2016-10-05 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  coefplot     * 1.2.4      2016-01-10 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  colorspace     1.3-2      2016-12-14 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  compiler       3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  config         0.2        2016-08-02 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  crayon         1.3.2.9000 2017-07-19 Github (gaborcsardi/crayon@750190f) </span>
<span class="co">#&gt;  data.table     1.10.4     2017-02-01 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  datasets     * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  DBI            0.7        2017-06-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  dbplyr         1.1.0      2017-06-27 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  devtools       1.13.2     2017-06-02 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  digest         0.6.12     2017-01-27 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  dplyr        * 0.7.2      2017-07-20 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  e1071        * 1.6-8      2017-02-02 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  evaluate       0.10.1     2017-06-24 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  FNN          * 1.1        2013-07-31 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  forcats      * 0.2.0      2017-01-23 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  foreach      * 1.4.3      2015-10-13 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  foreign        0.8-69     2017-06-22 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  gam          * 1.14-4     2017-04-25 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  gapminder    * 0.2.0      2015-12-31 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  gbm          * 2.1.3      2017-03-21 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  gganimate    * 0.1.0.9000 2017-05-26 Github (dgrtwo/gganimate@bf82002)   </span>
<span class="co">#&gt;  ggdendro     * 0.1-20     2016-04-27 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  ggplot2      * 2.2.1      2016-12-30 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  glue           1.1.1      2017-06-21 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  graphics     * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  grDevices    * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  grid         * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  gridExtra    * 2.2.1      2016-02-29 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  gtable         0.2.0      2016-02-26 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  haven        * 1.1.0      2017-07-09 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  highr          0.6        2016-05-09 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  hms            0.3        2016-11-22 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  htmltools      0.3.6      2017-04-28 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  htmlwidgets    0.9        2017-07-10 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  httpuv         1.3.5      2017-07-04 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  httr           1.2.1      2016-07-03 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  igraph         1.1.2      2017-07-21 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  ISLR         * 1.0        2013-06-11 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  iterators      1.0.8      2015-10-13 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  janeaustenr    0.1.5      2017-06-10 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  jsonlite       1.5        2017-06-01 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  kknn         * 1.3.1      2016-03-26 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  knitr        * 1.16       2017-05-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  labeling       0.3        2014-08-23 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  lattice      * 0.20-35    2017-03-25 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  lazyeval       0.2.0      2016-06-12 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  lme4         * 1.1-13     2017-04-19 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  lmtest       * 0.9-35     2017-02-11 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  lubridate      1.6.0      2016-09-13 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  magrittr       1.5        2014-11-22 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  MASS           7.3-47     2017-02-26 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  Matrix       * 1.2-10     2017-05-03 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  MatrixModels   0.4-1      2015-08-22 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  memoise        1.1.0      2017-04-21 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  methods      * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  mgcv           1.8-18     2017-07-28 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  mime           0.5        2016-07-07 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  minqa          1.2.4      2014-10-09 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  mnormt         1.5-5      2016-10-15 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  ModelMetrics   1.1.0      2016-08-26 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  modelr       * 0.1.1      2017-07-24 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  modeltools     0.2-21     2013-09-02 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  munsell        0.4.3      2016-02-13 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  nlme           3.1-131    2017-02-06 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  nloptr         1.0.4      2014-08-04 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  NLP          * 0.1-10     2017-02-21 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  nnet         * 7.3-12     2016-02-02 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  nycflights13   0.2.2      2017-01-27 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  parallel     * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  pbkrtest       0.4-7      2017-03-15 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  pkgconfig      2.0.1      2017-03-21 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  plotly       * 4.7.1      2017-07-29 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  plyr           1.8.4      2016-06-08 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  pROC         * 1.10.0     2017-06-10 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  psych          1.7.5      2017-05-03 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  purrr        * 0.2.2.2    2017-05-11 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  quantreg       5.33       2017-04-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  R6             2.2.2      2017-06-17 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  randomForest * 4.6-12     2015-10-07 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  rappdirs       0.3.1      2016-03-28 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  rcfss        * 0.1.5      2017-07-31 local                               </span>
<span class="co">#&gt;  RColorBrewer * 1.1-2      2014-12-07 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  Rcpp           0.12.12    2017-07-15 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  readr        * 1.1.1      2017-05-16 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  readxl         1.0.0      2017-04-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  reshape2       1.4.2      2016-10-22 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  rlang          0.1.1      2017-05-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  rmarkdown      1.6        2017-06-15 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  rprojroot      1.2        2017-01-16 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  RSQLite      * 2.0        2017-06-19 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  rstudioapi     0.6        2016-06-27 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  rvest          0.3.2      2016-06-17 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  scales         0.4.1      2016-11-09 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  shiny          1.0.3      2017-04-26 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  slam           0.1-40     2016-12-01 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  SnowballC      0.5.1      2014-08-09 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  sparklyr     * 0.6.0      2017-07-29 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  SparseM        1.77       2017-04-23 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  splines      * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  stats        * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  stats4         3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  stringi        1.1.5      2017-04-07 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  stringr      * 1.2.0      2017-02-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  survival     * 2.41-3     2017-04-04 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  tibble       * 1.3.3      2017-05-28 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tidyr        * 0.6.3      2017-05-15 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tidytext     * 0.1.3      2017-06-19 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  tidyverse    * 1.1.1.9000 2017-07-19 Github (tidyverse/tidyverse@a028619)</span>
<span class="co">#&gt;  titanic      * 0.1.0      2015-08-31 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tm           * 0.7-1      2017-03-02 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tokenizers     0.1.4      2016-08-29 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tools          3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  topicmodels  * 0.2-6      2017-04-18 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tree         * 1.0-37     2016-01-21 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  tweenr       * 0.1.5      2016-10-10 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  useful         1.2.3      2017-06-07 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  utils        * 3.4.1      2017-07-07 local                               </span>
<span class="co">#&gt;  viridisLite    0.2.0      2017-03-24 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  withr          2.0.0      2017-07-28 CRAN (R 3.4.1)                      </span>
<span class="co">#&gt;  xml2           1.1.1      2017-01-24 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  xtable         1.8-2      2016-02-05 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  yaml           2.1.14     2016-11-12 CRAN (R 3.4.0)                      </span>
<span class="co">#&gt;  zoo          * 1.8-0      2017-04-12 CRAN (R 3.4.0)</span></code></pre></div>
</div>

<p>This work is licensed under the  <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 Creative Commons License</a>.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

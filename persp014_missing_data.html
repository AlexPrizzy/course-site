<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="MACS 30200 - Perspectives on Computational Research" />


<title>Missing data and multiple imputation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45631879-2', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computing for the Social Sciences</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="faq.html">FAQ</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Missing data and multiple imputation</h1>
<h4 class="author"><em>MACS 30200 - Perspectives on Computational Research</em></h4>

</div>


<div id="objectives" class="section level1">
<h1>Objectives</h1>
<ul>
<li>Define missing data and patterns of missingness</li>
<li>Identify traditional approaches to missing data</li>
<li>Define imputation and multiple imputation</li>
<li>Summarize maximum-likelihood estimation for MAR data</li>
<li>Define Bayesian multiple imputation</li>
<li>Demonstrate how to conduct inference on MI datasets</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(forcats)
<span class="kw">library</span>(modelr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(car)
<span class="kw">library</span>(rcfss)
<span class="kw">library</span>(RColorBrewer)

<span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">3</span>)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
<span class="kw">theme_set</span>(<span class="kw">theme_minimal</span>())</code></pre></div>
</div>
<div id="missing-data" class="section level1">
<h1>Missing data</h1>
<div id="causes-of-missingness" class="section level2">
<h2>Causes of missingness</h2>
<ul>
<li>Surveys
<ul>
<li><strong>Global or unit non-response</strong> - individuals refuse to participate in or answer questions in a survey</li>
<li><strong>Item non-response</strong> - individual may not know the answer to or refuses to answer a specific question on the survey</li>
</ul></li>
<li>Errors in data collection</li>
<li>Intentionally built into the research design (e.g. survey experiments)</li>
<li><strong>Censored values</strong>
<ul>
<li>Data values in the study are censored</li>
<li>Survival analysis aka duration analysis aka event-history analysis</li>
<li>Follow individuals for a fixed period of time waiting for an event to happen</li>
<li>When the event occurs, record the time elapsed</li>
<li>If the event never occurs, the outcome is censored (i.e. missing)</li>
</ul></li>
</ul>
</div>
<div id="patterns-of-missingness" class="section level2">
<h2>Patterns of missingness</h2>
<div id="missing-completely-at-random-mcar" class="section level3">
<h3>Missing completely at random (MCAR)</h3>
<p>Data are <strong>missing completely at random</strong> if the missing data can be regarded as a simple ranom sample of the complete data. The probability that a data value is missing is unrelated to the data value itself or any other value, missing or observed, in the data set.</p>
</div>
<div id="missing-at-random-mar" class="section level3">
<h3>Missing at random (MAR)</h3>
<p>Data are <strong>missing at random</strong> if the missingness is related to the observed data <em>but not the missing data</em>. That is, conditional on the observed data, missingness is as if random. Consider a survey where certain individuals refuse to report their income, and these people differ systematically in income from the sample as a whole.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> However, if the observations are independently sampled so that one respondent’s decision to withhold information about income is independent of other respondents’ decision to withhold information about income, and if conditional on the information that the respondent does provide (e.g. education, occupation, political affiliation) failure to provide information on income is independent of income itself, the the data is MAR.</p>
<blockquote>
<p>MCAR is a special case of MAR.</p>
</blockquote>
</div>
<div id="missing-not-at-random-mnar" class="section level3">
<h3>Missing not at random (MNAR)</h3>
<p>If missingness is related to the missing values themselves <em>even when the information in the observed data is taken into account</em>, then the missing data is <strong>missing not at random</strong>. So if conditional on all the observed data, individuals with higher incomes are more likely to withhold information about their incomes, then the missing income data is MNAR.</p>
</div>
</div>
<div id="why-we-should-care-about-missingness-patterns" class="section level2">
<h2>Why we should care about missingness patterns</h2>
<p>If data are MCAR or MAR, then we don’t need to model the process that generates the missing data in order to accomodate the missing data. This means that when data are MCAR or MAR, the <strong>mechanism</strong> that produces the missing data is <strong>ignorable</strong>. But when data are MNAR, the mechanism is <strong>non-ignorable</strong> and it becomes necessary to model this mechanism in order to deal with the missingness in a valid way.</p>
<p>Even more depressingly, you rarely if ever can test to see if your data are MCAR, MAR, or MNAR <strong>because the information needed to make that determination is missing</strong>.</p>
</div>
<div id="simulated-examples-of-missingness-patterns" class="section level2">
<h2>Simulated examples of missingness patterns</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_sim &lt;-<span class="st"> </span><span class="dv">250</span> <span class="co"># Number of random samples</span>

<span class="co"># Target parameters for univariate normal distributions</span>
rho &lt;-<span class="st"> </span><span class="dv">2</span> /<span class="st"> </span><span class="dv">3</span>

mu1 &lt;-<span class="st"> </span><span class="dv">10</span>
mu2 &lt;-<span class="st"> </span><span class="dv">20</span>

s1 &lt;-<span class="st"> </span><span class="dv">9</span>
s2 &lt;-<span class="st"> </span><span class="dv">16</span>
s1s2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(s1) *<span class="st"> </span><span class="kw">sqrt</span>(s2) *<span class="st"> </span>rho

<span class="co"># Parameters for bivariate normal distribution</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(mu1, mu2) <span class="co"># Mean </span>
sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(s1, s1s2, s1s2, s2), <span class="dv">2</span>) <span class="co"># Covariance matrix</span>
data_sim &lt;-<span class="st"> </span>MASS::<span class="kw">mvrnorm</span>(n_sim, mu, sigma) %&gt;%
<span class="st">  </span>as_tibble %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">x1 =</span> V1,
         <span class="dt">x2 =</span> V2)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># correlation coefficient</span>
<span class="kw">cor</span>(data_sim)</code></pre></div>
<pre><code>##       x1    x2
## x1 1.000 0.649
## x2 0.649 1.000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># regression models</span>
<span class="kw">lm</span>(x2 ~<span class="st"> </span>x1, <span class="dt">data =</span> data_sim)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x2 ~ x1, data = data_sim)
## 
## Coefficients:
## (Intercept)           x1  
##      11.484        0.853</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(x1 ~<span class="st"> </span>x2, <span class="dt">data =</span> data_sim)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x1 ~ x2, data = data_sim)
## 
## Coefficients:
## (Intercept)           x2  
##      0.0948       0.4943</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot of data</span>
<span class="kw">ggplot</span>(data_sim, <span class="kw">aes</span>(x1, x2)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Complete data&quot;</span>,
       <span class="dt">x =</span> <span class="kw">expression</span>(X[<span class="dv">1</span>]),
       <span class="dt">y =</span> <span class="kw">expression</span>(X[<span class="dv">2</span>]))</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/sim-mod-1.png" width="672" /></p>
<p>What happens to the data under the three mechanisms for generating missing data?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mcar &lt;-<span class="st"> </span>data_sim %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">na =</span> <span class="kw">ifelse</span>(<span class="kw">row_number</span>(x2) %in%<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq_len</span>(n_sim), <span class="dv">100</span>), <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))

<span class="kw">ggplot</span>(mcar, <span class="kw">aes</span>(x1, x2)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> na, <span class="dt">alpha =</span> na)) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) +
<span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Missing completely at random&quot;</span>,
       <span class="dt">x =</span> <span class="kw">expression</span>(X[<span class="dv">1</span>]),
       <span class="dt">y =</span> <span class="kw">expression</span>(X[<span class="dv">2</span>]),
       <span class="dt">color =</span> <span class="st">&quot;Missing&quot;</span>,
       <span class="dt">alpha =</span> <span class="st">&quot;Missing&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/sim-mcar-1.png" width="672" /></p>
<p>100 observations on <span class="math inline">\(X_2\)</span> are selected at random and set to missing. Here the missing values of <span class="math inline">\(X_2\)</span> are MCAR and the subset of valid observations is a simple random sample of the full data set. The regression line with and without the missing values is relatively similar, though slightly different due to the lower sample size needed to calculate the parameter estimates and the standard errors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mar &lt;-<span class="st"> </span>data_sim %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">na =</span> .<span class="dv">5</span> +<span class="st"> </span>(<span class="dv">2</span> /<span class="st"> </span><span class="dv">3</span>) *<span class="st"> </span>(x1 -<span class="st"> </span><span class="dv">10</span>) +<span class="st"> </span><span class="kw">rnorm</span>(n_sim, <span class="dt">sd =</span> <span class="dv">2</span>),
         <span class="dt">na =</span> <span class="kw">logit2prob</span>(na),
         <span class="dt">na =</span> <span class="kw">as.logical</span>(<span class="kw">round</span>(na)))

<span class="kw">ggplot</span>(mar, <span class="kw">aes</span>(x1, x2)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> na, <span class="dt">alpha =</span> na)) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) +
<span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Missing at random&quot;</span>,
       <span class="dt">x =</span> <span class="kw">expression</span>(X[<span class="dv">1</span>]),
       <span class="dt">y =</span> <span class="kw">expression</span>(X[<span class="dv">2</span>]),
       <span class="dt">color =</span> <span class="st">&quot;Missing&quot;</span>,
       <span class="dt">alpha =</span> <span class="st">&quot;Missing&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/sim-mar-1.png" width="672" /></p>
<p>Here an observation’s missingness on <span class="math inline">\(X_2\)</span> is related to its observed value of <span class="math inline">\(X_1\)</span> in the logistic regression functional form:</p>
<p><span class="math display">\[\Pr(X_{i2} \text{is missing}) = \frac{1}{1 + \exp[\frac{1}{2} + \frac{2}{3}(X_{i1} - 10)]}\]</span></p>
<p>As <span class="math inline">\(X_1\)</span> increases, the probability that <span class="math inline">\(X_2\)</span> is missing increases. In the resulting dataset, 141 observations are missing. Because <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are positively correlated, there are relatively fewer small values of <span class="math inline">\(X_2\)</span> in the observed data versus the complete data. If we only look at observations with valid data on both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, then this subset of observations also has relatively few small values of <span class="math inline">\(X_1\)</span>. But because <span class="math inline">\(X_1\)</span> is fully observed, the missing data on <span class="math inline">\(X_2\)</span> are MAR.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mnar &lt;-<span class="st"> </span>data_sim %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">na =</span> .<span class="dv">5</span> +<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span><span class="dv">2</span>) *<span class="st"> </span>(x2 -<span class="st"> </span><span class="dv">20</span>) +<span class="st"> </span><span class="kw">rnorm</span>(n_sim, <span class="dt">sd =</span> <span class="dv">2</span>),
         <span class="dt">na =</span> <span class="kw">logit2prob</span>(na),
         <span class="dt">na =</span> <span class="kw">as.logical</span>(<span class="kw">round</span>(na)))

<span class="kw">ggplot</span>(mnar, <span class="kw">aes</span>(x1, x2)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> na, <span class="dt">alpha =</span> na)) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) +
<span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Missing not at random&quot;</span>,
       <span class="dt">x =</span> <span class="kw">expression</span>(X[<span class="dv">1</span>]),
       <span class="dt">y =</span> <span class="kw">expression</span>(X[<span class="dv">2</span>]),
       <span class="dt">color =</span> <span class="st">&quot;Missing&quot;</span>,
       <span class="dt">alpha =</span> <span class="st">&quot;Missing&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/sim-mnar-1.png" width="672" /></p>
<p>Finally, here an observation’s missingness on <span class="math inline">\(X_2\)</span> is related to the (potentially) unobserved value of <span class="math inline">\(X_2\)</span> itself:</p>
<p><span class="math display">\[\Pr(X_{i2} \text{is missing}) = \frac{1}{1 + \exp[\frac{1}{2} + \frac{1}{2}(X_{i2} - 20)]}\]</span></p>
<p>As <span class="math inline">\(X_2\)</span> increases, the probability that <span class="math inline">\(X_2\)</span> is missing increases. In the resulting dataset, 141 observations are missing. Here too there are relatively few small values of <span class="math inline">\(X_2\)</span>. Because missingness on <span class="math inline">\(X_2\)</span> depends on the value of <span class="math inline">\(X_2\)</span>, the missing data are MNAR. But again, we only know this because we generated the missingness ourselves; in the real world, you rarely can verify this pattern of missingness.</p>
</div>
</div>
<div id="traditional-approaches-to-missing-data" class="section level1">
<h1>Traditional approaches to missing data</h1>
<p>In deciding how to handle missingness, we should consider three questions:</p>
<ol style="list-style-type: decimal">
<li>Does the method provide <strong>consistent estimates</strong> of the population parameters?</li>
<li>Does the method provide <strong>valid statistical inferences</strong>?</li>
<li>Does the method use the observed data <strong>efficiently</strong> or does it recklessly discard information?</li>
</ol>
<div id="discarding-data" class="section level2">
<h2>Discarding data</h2>
<div id="complete-case-analysis" class="section level3">
<h3>Complete-case analysis</h3>
<p><strong>Complete-case analysis</strong> (or <strong>listwise</strong> or <strong>casewise</strong> deletion) is probably the most common approach for handling missing data. In this method, you ignore any observations with missing values on variables necessary to estimate the model.</p>
<p>The advantages of this method are that it:</p>
<ul>
<li>Is simple</li>
<li>Provides consistent estimates and valid inferences <strong>when the data is missing completely at random</strong></li>
<li>Provides consistent estimates of regression coefficients and valid inferences when missingness on all the variables in a regression does not depend on the response variable (even if the data is not MCAR)</li>
</ul>
<p>The disadvantages of this method are that it:</p>
<ul>
<li>Discards valuable information, decreasing efficiency</li>
<li>Becomes less efficient as missingness occurs in multiple variables. Even if missingness is only 5% for each individual variable, for a dataset with 10 variables we would expect only <span class="math inline">\(100 \times .95^10 = 60%\)</span> of the observations to be usable</li>
<li>When data is MAR or MNAR, listwise deletion provides biased results and invalid inferences</li>
</ul>
</div>
<div id="available-case-analysis" class="section level3">
<h3>Available-case analysis</h3>
<p><strong>Available-case analysis</strong> (or <strong>pairwise deletion</strong>) uses all nonmissing observations to compute each statistic of interest. In OLS, this means estimating the regression coefficients from the means, variances, and covariances of the variables rather than directly from the observations. While this appears to use more information than complete-case analysis, it can sometimes be <em>less efficient</em>. And by basing each statistic of interest on different subsets of the data, results can become nonsensical (e.g. correlations outside of the <span class="math inline">\([-1, +1]\)</span> range). Finally, this method is much more difficult to implement outside of OLS to other GLMs.</p>
</div>
</div>
<div id="imputation" class="section level2">
<h2>Imputation</h2>
<p><strong>Imputation</strong> refers to filling in missing data with plausible <strong>imputed</strong> values. The completed data set is then analyzed using traditional methods.</p>
<div id="unconditional-mean-imputation" class="section level3">
<h3>Unconditional mean imputation</h3>
<p><strong>Unconditional mean imputation</strong> replaces the missing value with the arithmetic mean of the observed values for the variable in question. Doing so preserves the mean of the variable, but decreases its variance and its covariance with other variables. This can lead to biased regression coefficients and invalid inferences even if the data is MCAR.</p>
</div>
<div id="conditional-mean-imputation" class="section level3">
<h3>Conditional-mean imputation</h3>
<p><strong>Conditional-mean imputation</strong> replaces missing data with predicted values obtained from a statistical learning model, typically a regression model. Using the available data, regress each variable with missing data on the other variables in the data set. Then use the regression model to generate predicted values for the missing data in the regressed variable. However this still leaves two problems:</p>
<ol style="list-style-type: decimal">
<li>Imputed values still tend to be less variable than the real data because they lack <strong>residual variation</strong></li>
<li>We still fail to account for uncertainty in the estimates of the regression coefficients used to obtain the imputed values</li>
</ol>
<p>How do all of these methods stack up?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_miss_stat &lt;-<span class="st"> </span>function(df){
  df %&gt;%
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mu_1 =</span> <span class="kw">mean</span>(x1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
              <span class="dt">mu_2 =</span> <span class="kw">mean</span>(x2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
              <span class="dt">sigma_1 =</span> <span class="kw">var</span>(x1, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>),
              <span class="dt">sigma_2 =</span> <span class="kw">var</span>(x2, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>),
              <span class="dt">sigma_12 =</span> <span class="kw">cov</span>(., <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)[<span class="dv">1</span>, <span class="dv">2</span>],
              <span class="dt">rho =</span> <span class="kw">cor</span>(., <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)[<span class="dv">1</span>, <span class="dv">2</span>],
              <span class="dt">beta_12 =</span> <span class="kw">lm</span>(x2 ~<span class="st"> </span>x1, <span class="dt">data =</span> .) %&gt;%<span class="st"> </span><span class="kw">coef</span>(.) %&gt;%<span class="st"> </span>.[[<span class="dv">2</span>]],
              <span class="dt">beta_21 =</span> <span class="kw">lm</span>(x1 ~<span class="st"> </span>x2, <span class="dt">data =</span> .) %&gt;%<span class="st"> </span><span class="kw">coef</span>(.)%&gt;%<span class="st"> </span>.[[<span class="dv">2</span>]]
    )
}

data_miss &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">mcar =</span> data_sim %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">x2 =</span> <span class="kw">replace</span>(x2, <span class="kw">sample</span>(<span class="kw">seq_len</span>(n_sim), <span class="dv">100</span>), <span class="ot">NA</span>)),
  <span class="dt">mar =</span> data_sim %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">na =</span> .<span class="dv">5</span> +<span class="st"> </span>(<span class="dv">2</span> /<span class="st"> </span><span class="dv">3</span>) *<span class="st"> </span>(x1 -<span class="st"> </span><span class="dv">10</span>) +<span class="st"> </span><span class="kw">rnorm</span>(n_sim, <span class="dt">sd =</span> <span class="dv">2</span>),
           <span class="dt">na =</span> <span class="kw">logit2prob</span>(na),
           <span class="dt">na =</span> <span class="kw">as.logical</span>(<span class="kw">round</span>(na)),
           <span class="dt">x2 =</span> <span class="kw">replace</span>(x2, na, <span class="ot">NA</span>)) %&gt;%
<span class="st">    </span><span class="kw">select</span>(-na),
  <span class="dt">mnar =</span> data_sim %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">na =</span> .<span class="dv">5</span> +<span class="st"> </span>(<span class="dv">1</span> /<span class="st"> </span><span class="dv">2</span>) *<span class="st"> </span>(x2 -<span class="st"> </span><span class="dv">20</span>) +<span class="st"> </span><span class="kw">rnorm</span>(n_sim, <span class="dt">sd =</span> <span class="dv">2</span>),
           <span class="dt">na =</span> <span class="kw">logit2prob</span>(na),
           <span class="dt">na =</span> <span class="kw">as.logical</span>(<span class="kw">round</span>(na)),
           <span class="dt">x2 =</span> <span class="kw">replace</span>(x2, na, <span class="ot">NA</span>)) %&gt;%
<span class="st">    </span><span class="kw">select</span>(-na)
)

<span class="co"># complete cases</span>
complete_cases &lt;-<span class="st"> </span>data_miss %&gt;%
<span class="st">  </span><span class="kw">map</span>(na.omit) %&gt;%
<span class="st">  </span><span class="kw">map_df</span>(get_miss_stat, <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)

<span class="co"># available cases</span>
available_cases &lt;-<span class="st"> </span>data_miss %&gt;%
<span class="st">  </span><span class="kw">map_df</span>(~<span class="st"> </span>.x %&gt;%
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mu_1 =</span> <span class="kw">mean</span>(x1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
              <span class="dt">mu_2 =</span> <span class="kw">mean</span>(x2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
              <span class="dt">sigma_1 =</span> <span class="kw">var</span>(x1, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>),
              <span class="dt">sigma_2 =</span> <span class="kw">var</span>(x2, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>),
              <span class="dt">sigma_12 =</span> <span class="kw">cov</span>(., <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)[<span class="dv">1</span>, <span class="dv">2</span>],
              <span class="dt">rho =</span> <span class="kw">cor</span>(., <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)[<span class="dv">1</span>, <span class="dv">2</span>],
              <span class="dt">beta_12 =</span> psych::<span class="kw">mat.regress</span>(<span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x1&quot;</span>,
                   <span class="dt">data =</span> <span class="kw">cov</span>(., <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>),
                   <span class="dt">n.obs =</span> <span class="kw">nrow</span>(<span class="kw">na.omit</span>(.))) %&gt;%
<span class="st">                </span>.$beta %&gt;%
<span class="st">                </span>.[[<span class="dv">1</span>]],
              <span class="dt">beta_21 =</span> psych::<span class="kw">mat.regress</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>,
                   <span class="dt">data =</span> <span class="kw">cov</span>(., <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>),
                   <span class="dt">n.obs =</span> <span class="kw">nrow</span>(<span class="kw">na.omit</span>(.))) %&gt;%
<span class="st">                </span>.$beta %&gt;%
<span class="st">                </span>.[[<span class="dv">1</span>]]
    ), <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mean imputation</span>
mean_imp &lt;-<span class="st"> </span>data_miss %&gt;%
<span class="st">  </span><span class="kw">map</span>(~<span class="st"> </span><span class="kw">mutate</span>(.x, <span class="dt">x2 =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(x2), <span class="kw">mean</span>(x2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), x2))) %&gt;%
<span class="st">  </span><span class="kw">map_df</span>(get_miss_stat, <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)

<span class="co"># regression imputation</span>
reg_imp &lt;-<span class="st"> </span>data_miss %&gt;%
<span class="st">  </span><span class="kw">map</span>(~<span class="st"> </span>.x %&gt;%
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">x2_imp =</span> <span class="kw">lm</span>(x2 ~<span class="st"> </span>x1, <span class="dt">data =</span> .) %&gt;%
<span class="st">                 </span><span class="kw">predict</span>(., <span class="dt">newdata =</span> .x),
               <span class="dt">x2 =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(x2), x2_imp, x2))) %&gt;%
<span class="st">  </span><span class="kw">map_df</span>(get_miss_stat, <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)

sum_stats &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(
  <span class="st">`</span><span class="dt">Population parameters</span><span class="st">`</span> =<span class="st"> </span><span class="kw">data_frame</span>(
    <span class="dt">mu_1 =</span> <span class="dv">10</span>,
    <span class="dt">mu_2 =</span> <span class="dv">20</span>,
    <span class="dt">sigma_1 =</span> <span class="dv">9</span>,
    <span class="dt">sigma_2 =</span> <span class="dv">16</span>,
    <span class="dt">sigma_12 =</span> <span class="dv">8</span>,
    <span class="dt">rho =</span> .<span class="dv">667</span>,
    <span class="dt">beta_12 =</span> .<span class="dv">5</span>,
    <span class="dt">beta_21 =</span> .<span class="dv">889</span>),
  <span class="st">`</span><span class="dt">Complete data</span><span class="st">`</span> =<span class="st"> </span><span class="kw">get_miss_stat</span>(data_sim),
  <span class="st">`</span><span class="dt">Complete cases</span><span class="st">`</span> =<span class="st"> </span>complete_cases,
  <span class="st">`</span><span class="dt">Available cases</span><span class="st">`</span> =<span class="st"> </span>available_cases,
  <span class="st">`</span><span class="dt">Mean imputation</span><span class="st">`</span> =<span class="st"> </span>mean_imp,
  <span class="st">`</span><span class="dt">Regression imputation</span><span class="st">`</span> =<span class="st"> </span>reg_imp,
  <span class="dt">.id =</span> <span class="st">&quot;method&quot;</span>
) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">ifelse</span>(method ==<span class="st"> &quot;Population parameters&quot;</span>, <span class="st">&quot;Parameter&quot;</span>, id),
         <span class="dt">id =</span> <span class="kw">ifelse</span>(method ==<span class="st"> &quot;Complete data&quot;</span>, <span class="st">&quot;Complete data&quot;</span>, id)) %&gt;%
<span class="st">  </span><span class="kw">gather</span>(param, value, -method, -id) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;mu_1&quot;</span>, <span class="st">&quot;mu[1]&quot;</span>, param),
         <span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;mu_2&quot;</span>, <span class="st">&quot;mu[2]&quot;</span>, param),
         <span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;sigma_1&quot;</span>, <span class="st">&quot;sigma[1]^2&quot;</span>, param),
         <span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;sigma_2&quot;</span>, <span class="st">&quot;sigma[2]^2&quot;</span>, param),
         <span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;sigma_12&quot;</span>, <span class="st">&quot;sigma[12]&quot;</span>, param),
         <span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;beta_12&quot;</span>, <span class="st">&quot;beta[12]&quot;</span>, param),
         <span class="dt">param =</span> <span class="kw">ifelse</span>(param ==<span class="st"> &quot;beta_21&quot;</span>, <span class="st">&quot;beta[21]&quot;</span>, param))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_stats %&gt;%
<span class="st">  </span><span class="kw">filter</span>(id %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mcar&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;mnar&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">factor</span>(id, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;mcar&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;mnar&quot;</span>),
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;MCAR&quot;</span>, <span class="st">&quot;MAR&quot;</span>, <span class="st">&quot;MNAR&quot;</span>))) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(id, value, <span class="dt">color =</span> method)) +
<span class="st">  </span><span class="kw">facet_wrap</span>( ~<span class="st"> </span>param, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>,
              <span class="dt">labeller =</span> <span class="st">&quot;label_parsed&quot;</span>) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">data =</span> <span class="kw">filter</span>(sum_stats, id ==<span class="st"> &quot;Parameter&quot;</span>),
             <span class="kw">aes</span>(<span class="dt">yintercept =</span> value)) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>, 
                     <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="st">&quot;Estimated parameter value&quot;</span>,
       <span class="dt">color =</span> <span class="ot">NULL</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">30</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/compare-imputation-plot-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="maximum-likelihood-estimation-for-data-mar" class="section level1">
<h1>Maximum-likelihood estimation for data MAR</h1>
<p>When data are MAR (or MCAR), we can use maximum-likelihood estimation to estimate the parameters of interest and generate imputed values for the missing data. This requires several assumptions about the missingness mechanism and the distribution of the complete data.</p>
<p>Let <span class="math inline">\(p(\mathbf{X}, \theta) = p(\mathbf{X}_{\text{obs}}, \mathbf{X}_{\text{mis}}; \theta)\)</span> represent the joint probability density for the complete data <span class="math inline">\(\mathbf{X}\)</span>, which is composed of the observed and missing components denoted by <span class="math inline">\(\mathbf{X}_{\text{obs}}, \mathbf{X}_{\text{mis}}\)</span>. The vector <span class="math inline">\(\theta\)</span> contains the unknown parameters on which the complete-data distribution depends. For example, if the variables in <span class="math inline">\(\mathbf{X}\)</span> are multivariately normally distributed, then <span class="math inline">\(\theta\)</span> includes the population means and covariances among the variables.</p>
<p>If data is MAR, then the ML estimate <span class="math inline">\(\hat{\theta}\)</span> of <span class="math inline">\(\theta\)</span> can be obtained from the marginal distribution of the observed data by integrating over the missing data:</p>
<p><span class="math display">\[p(\mathbf{X}_\text{obs}; \theta) = \int{p(\mathbf{X}_{\text{obs}}, \mathbf{X}_{\text{mis}}; \theta)} d\mathbf{X}_{\text{mis}}\]</span></p>
<p>We’ll skip the math for all of this<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>, but the important thing to note is that the ML estimate only has a closed-form solution when missingness follows an arbitrary pattern (i.e. MAR). We can use iterative processes such as an <strong>expectation-maximization (EM) algorithm</strong> to find the ML estimates in the absence of arbitrary patterns of missingness. The algorithm is a two-step process, the <strong>expectation</strong> step and the <strong>maximization</strong> step:</p>
<ol style="list-style-type: decimal">
<li><p>Find the expectation of the complete-data log-likelihood, integrating over the missing data given the observed data and the current estimates of the parameters</p>
<span class="math display">\[E[\log_eL(\theta; \mathbf{X})| \theta^(l)] = \int{\log_e L(\theta; \mathbf{X} p(\mathbf{X}_\text{mis} | \mathbf{X}_\text{obs}, \theta^{(l)})) d \mathbf{X}_\text{mis}}\]</span></li>
<li><p>Find the values <span class="math inline">\(\theta^{(l+1)}\)</span> of <span class="math inline">\(\theta\)</span> that maximize the expected log-likelihood <span class="math inline">\(E[\log_eL(\theta; \mathbf{X})| \theta^(l)]\)</span>. These become the parameter estimates for the next iteration.</p></li>
</ol>
<p>When the parameter estimates stop changing from one iteration to the next, they converge to the ML estimates <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="bayesian-multiple-imputation" class="section level1">
<h1>Bayesian multiple imputation</h1>
<p><strong>Bayesian multiple imputation</strong> (MI) is a flexible method for dealing with missing data MAR. It starts by specifying the distribution of the complete data; typically the data is assumed to be multivariate normal. The key difference is that this method reflects uncertainty associated with missing data by imputing multiple values for each missing data value (i.e. multiple imputation), producing several complete datasets. Each dataset is then analyzed independently and in parallel, estimating parameters of interest and standard errors for each imputed dataset. The estimated parameters are then averaged together across the imputed datasets. Standard errors are also combined, taking into account the variation among the estimates in the several datasets and capturing the added uncertainty due to having to deal with missing data.</p>
<p>The method is <strong>Bayesian</strong> because each estimate of the parameters and standard errors is drawn from the <strong>posterior distribution</strong> of the parameters, typically assuming a non-informative (flat) prior distribution. We will discuss Bayesian inference techniques in a couple weeks, but the important thing to note is that this method directly accounts for our uncertainty associated with both the sampling variance of the coefficients used in the imputation model as well as the uncertainty derived from the missingness itself.</p>
<div id="inference-for-individual-coefficients" class="section level2">
<h2>Inference for individual coefficients</h2>
<p>We use this method to produce <span class="math inline">\(g\)</span> complete datasets. MI estimates of population parameters of interest (such as a regression coefficient) are obtained by averaging over the imputed datasets:</p>
<p><span class="math display">\[\tilde{\beta}_j \equiv \frac{\sum_{l=1}^g B_j^{(l)}}{g}\]</span></p>
<blockquote>
<p>This averaging method applies to any type of parameter that for the separate estimates is approximately normally distributed. This applies to OLS regression estimates, GLM coefficient estimates, or by any parametric method of regression analysis.</p>
</blockquote>
<p>Standard errors of the estimated coefficients are obtained by combining information about within- and between-imputation variation in the coefficients:</p>
<p><span class="math display">\[\tilde{\text{SE}}(\tilde{\beta}_j) = \sqrt{V_j^{(W)} + \frac{g + 1}{g} V_j^{(B)}}\]</span></p>
<p>where the within-imputation component is:</p>
<p><span class="math display">\[V_j^{(W)} = \frac{\sum_{l=1}^g \text{SE}^2(B_j^{(l)})}{g}\]</span></p>
<p>and the between-imputation component is:</p>
<p><span class="math display">\[V_j^{(B)} = \frac{\sum_{l=1}^g (B_j^{(l)} - \tilde{B}_j)^2}{g-1}\]</span></p>
<p><span class="math inline">\(\text{SE}^2(B_j^{(l)})\)</span> is the standard error of <span class="math inline">\(B_j\)</span>, computed in the usual manner for the <span class="math inline">\(l\)</span>th imputed dataset.</p>
<p>Inference based on <span class="math inline">\(\tilde{\text{SE}}(\tilde{\beta}_j)\)</span> and <span class="math inline">\(\tilde{\text{SE}}(\tilde{\beta}_j)\)</span> follows the <span class="math inline">\(t\)</span>-distribution with degrees of freedom:</p>
<p><span class="math display">\[df_j = (g-1) \left ( 1 + \frac{g}{g+1} \times \frac{V_j^{(W)}}{V_j^{(B)}} \right)^2\]</span></p>
</div>
<div id="practical-considerations-for-multiple-imputation" class="section level2">
<h2>Practical considerations for multiple imputation</h2>
<p>The MI method is typically implemented assuming the complete data follows a multivariate normal distribution. Violation of this assumption isn’t necessarily a dealbreaker for relying on MI estimates. However MI can only preserve features of the dataset represented in the imputation model. Therefore you need to think carefully about which features (variables) need to be preserved when building the imputation model to ensure those particular features will appear in the final statistical model.</p>
<ul>
<li><strong>Include variables in the imputation model that make the assumption of ignorable missingness reasonable.</strong> Remember that the MI method assumes data is MAR. So for this to work on data MNAR, we want to build a predictive model that does a great job of predicting missing values. Typically this includes using variables that will be in the final statistical model as well as variables in the dataset not used in the final statistical model, variables strongly correlated with the variable with missingness (as measured by the complete observations), and even the response variable itself. Think of the imputation model as a pure prediction model - you are not conducting inference on the imputation model itself, so it can be highly complex.</li>
<li><strong>Transform variables to approximately normal.</strong> After the imputed data are obtained, you can transform them back to their original scales prior to analyzing the completed datasets.</li>
<li><strong>Adjust the imputed data to resemble the original data.</strong> So if you have a dichotomous variable with imputed values of <span class="math inline">\(.3\)</span> or <span class="math inline">\(.785\)</span>, round them to <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</li>
<li><strong>Make sure the imputation model captures relevant features of the data.</strong> Again, consider how the data will eventually be analyzed. The multivariate normal distribution ensures that regressions of one variable on others are linear and additive. If you are estimating a <strong>nonlinear</strong> relationship (either polynomial or interactive), then provide for that in the imputation model (explicitly add the polynomial or interaction term).</li>
<li><strong><span class="math inline">\(g\)</span> doesn’t need to be large.</strong> For most situations, <span class="math inline">\(g=5\)</span> or <span class="math inline">\(g=10\)</span> is actually suitable for statistical inference.</li>
</ul>
</div>
</div>
<div id="regression-model-of-infant-mortality-with-mi" class="section level1">
<h1>Regression model of infant mortality with MI</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">un &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data/UnitedNations.txt&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot; &quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(un, <span class="kw">aes</span>(GDPperCapita, infantMortality)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales::dollar) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (in USD)&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Infant mortality rate (per 1,000)&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/plot-infant-gdp-1.png" width="672" /></p>
<p>The above figure shows the relationship between GDP per capita and infant mortality in 193 countries, part of a larger dataset of 207 countries compiled by the United Nations. The amount of missingness in the figure is therefore small, approximately 7% of the cases.</p>
<p>Let’s now estimate a linear regression model of infant mortality not only on GDP per capita but also the percentage of married women practicing contraception and the average number of years of education for women. To linearize the model, we log-transform both infant mortality and GDP.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(un, <span class="kw">aes</span>(GDPperCapita, infantMortality)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales::dollar) +
<span class="st">  </span><span class="kw">scale_y_log10</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (in USD)&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Infant mortality rate (per 1,000)&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/log-log-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mortal_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(infantMortality) ~<span class="st"> </span><span class="kw">log</span>(GDPperCapita) +
<span class="st">                   </span>contraception +<span class="st"> </span>educationFemale,
                 <span class="dt">data =</span> un)
<span class="kw">tidy</span>(mortal_mod)</code></pre></div>
<pre><code>##                term estimate std.error statistic  p.value
## 1       (Intercept)   6.8840   0.29039     23.71 1.58e-31
## 2 log(GDPperCapita)  -0.2943   0.05765     -5.10 3.85e-06
## 3     contraception  -0.0113   0.00424     -2.66 1.01e-02
## 4   educationFemale  -0.0770   0.03378     -2.28 2.63e-02</code></pre>
<p>With listwise deletion, we are left with just 62 observations. The missingness for each variable is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">un %&gt;%
<span class="st">  </span><span class="kw">select</span>(infantMortality, GDPperCapita, contraception, educationFemale) %&gt;%
<span class="st">  </span><span class="kw">summarize_all</span>(<span class="kw">funs</span>(<span class="kw">sum</span>(<span class="kw">is.na</span>(.)))) %&gt;%
<span class="st">  </span>knitr::<span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">infantMortality</th>
<th align="right">GDPperCapita</th>
<th align="right">contraception</th>
<th align="right">educationFemale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">6</td>
<td align="right">10</td>
<td align="right">63</td>
<td align="right">131</td>
</tr>
</tbody>
</table>
<div id="amelia" class="section level2">
<h2><code>Amelia</code></h2>
<p><a href="https://gking.harvard.edu/Amelia"><code>Amelia</code></a> is a package for R that provides a Bayesian EM-based algorithm for multiple imputation.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> To create multiple imputations in Amelia, we use <code>amelia()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Amelia)
un.out &lt;-<span class="st"> </span><span class="kw">amelia</span>(<span class="kw">as.data.frame</span>(un), <span class="dt">m =</span> <span class="dv">5</span>, <span class="dt">idvars =</span> <span class="kw">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;region&quot;</span>))</code></pre></div>
<pre><code>## Warning: There are observations in the data that are completely missing. 
##          These observations will remain unimputed in the final datasets. 
## -- Imputation 1 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56
## 
## -- Imputation 2 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
##  61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
##  81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98
## 
## -- Imputation 3 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57
## 
## -- Imputation 4 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
##  61 62 63 64 65 66
## 
## -- Imputation 5 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
##  61 62 63 64 65 66 67 68 69 70</code></pre>
<blockquote>
<p>If your data frame is a <code>tibble</code>, you need to turn back into a plain data frame using <code>as.data.frame()</code> in order to successfully impute the data.</p>
</blockquote>
<p>Here we specify <code>country</code> and <code>region</code> are id variables (text strings) and we don’t want to use them to generate imputed values. By default, <code>amelia()</code> uses all the variables in their raw forms to impute missing values for each variable. Clearly we still want to tune this approach, but for now let’s run with it. The list of imputed data frames is stored in the <code>imputations</code> element:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(un.out$imputations, <span class="dt">max.level =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## List of 5
##  $ imp1:&#39;data.frame&#39;:    207 obs. of  14 variables:
##   ..$ country               : chr [1:207] &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American.Samoa&quot; ...
##   ..$ region                : chr [1:207] &quot;Asia&quot; &quot;Europe&quot; &quot;Africa&quot; &quot;Asia&quot; ...
##   ..$ tfr                   : num [1:207] 6.9 2.6 3.81 1.86 NA ...
##   ..$ contraception         : num [1:207] -12 71.9 52 43.3 NA ...
##   ..$ educationMale         : num [1:207] 4.05 11.02 11.1 13 NA ...
##   ..$ educationFemale       : num [1:207] 0.319 10.646 9.9 12.313 NA ...
##   ..$ lifeMale              : num [1:207] 45 68 67.5 68 NA ...
##   ..$ lifeFemale            : num [1:207] 46 74 70.3 73 NA ...
##   ..$ infantMortality       : num [1:207] 154 32 44 11 NA 124 24 22 25 6 ...
##   ..$ GDPperCapita          : num [1:207] 2848 863 1531 3207 NA ...
##   ..$ economicActivityMale  : num [1:207] 87.5 78.3 76.4 58.8 NA ...
##   ..$ economicActivityFemale: num [1:207] 7.2 68.9 7.8 42.4 NA ...
##   ..$ illiteracyMale        : num [1:207] 52.8 8.941 26.1 0.264 NA ...
##   ..$ illiteracyFemale      : num [1:207] 85 16.02 51 0.36 NA ...
##   ..- attr(*, &quot;spec&quot;)=List of 2
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;col_spec&quot;
##  $ imp2:&#39;data.frame&#39;:    207 obs. of  14 variables:
##   ..$ country               : chr [1:207] &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American.Samoa&quot; ...
##   ..$ region                : chr [1:207] &quot;Asia&quot; &quot;Europe&quot; &quot;Africa&quot; &quot;Asia&quot; ...
##   ..$ tfr                   : num [1:207] 6.9 2.6 3.81 3.39 NA ...
##   ..$ contraception         : num [1:207] 17.3 50.8 52 19.8 NA ...
##   ..$ educationMale         : num [1:207] 7.2 7.72 11.1 12.77 NA ...
##   ..$ educationFemale       : num [1:207] 2.11 9.37 9.9 12.76 NA ...
##   ..$ lifeMale              : num [1:207] 45 68 67.5 68 NA ...
##   ..$ lifeFemale            : num [1:207] 46 74 70.3 73 NA ...
##   ..$ infantMortality       : num [1:207] 154 32 44 11 NA 124 24 22 25 6 ...
##   ..$ GDPperCapita          : num [1:207] 2848 863 1531 8316 NA ...
##   ..$ economicActivityMale  : num [1:207] 87.5 90.1 76.4 58.8 NA ...
##   ..$ economicActivityFemale: num [1:207] 7.2 60.4 7.8 42.4 NA ...
##   ..$ illiteracyMale        : num [1:207] 52.8 2.955 26.1 0.264 NA ...
##   ..$ illiteracyFemale      : num [1:207] 85 3.52 51 0.36 NA ...
##   ..- attr(*, &quot;spec&quot;)=List of 2
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;col_spec&quot;
##  $ imp3:&#39;data.frame&#39;:    207 obs. of  14 variables:
##   ..$ country               : chr [1:207] &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American.Samoa&quot; ...
##   ..$ region                : chr [1:207] &quot;Asia&quot; &quot;Europe&quot; &quot;Africa&quot; &quot;Asia&quot; ...
##   ..$ tfr                   : num [1:207] 6.9 2.6 3.81 3.35 NA ...
##   ..$ contraception         : num [1:207] -7.24 56.17 52 67.65 NA ...
##   ..$ educationMale         : num [1:207] 6.16 9.37 11.1 14 NA ...
##   ..$ educationFemale       : num [1:207] 3.58 10.19 9.9 13.66 NA ...
##   ..$ lifeMale              : num [1:207] 45 68 67.5 68 NA ...
##   ..$ lifeFemale            : num [1:207] 46 74 70.3 73 NA ...
##   ..$ infantMortality       : num [1:207] 154 32 44 11 NA 124 24 22 25 6 ...
##   ..$ GDPperCapita          : num [1:207] 2848 863 1531 3568 NA ...
##   ..$ economicActivityMale  : num [1:207] 87.5 78.9 76.4 58.8 NA ...
##   ..$ economicActivityFemale: num [1:207] 7.2 63 7.8 42.4 NA ...
##   ..$ illiteracyMale        : num [1:207] 52.8 1.728 26.1 0.264 NA ...
##   ..$ illiteracyFemale      : num [1:207] 85 14.92 51 0.36 NA ...
##   ..- attr(*, &quot;spec&quot;)=List of 2
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;col_spec&quot;
##  $ imp4:&#39;data.frame&#39;:    207 obs. of  14 variables:
##   ..$ country               : chr [1:207] &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American.Samoa&quot; ...
##   ..$ region                : chr [1:207] &quot;Asia&quot; &quot;Europe&quot; &quot;Africa&quot; &quot;Asia&quot; ...
##   ..$ tfr                   : num [1:207] 6.9 2.6 3.81 1.66 NA ...
##   ..$ contraception         : num [1:207] 19.9 35.3 52 66.9 NA ...
##   ..$ educationMale         : num [1:207] 6.52 5.18 11.1 13.19 NA ...
##   ..$ educationFemale       : num [1:207] 2.28 5.72 9.9 13.49 NA ...
##   ..$ lifeMale              : num [1:207] 45 68 67.5 68 NA ...
##   ..$ lifeFemale            : num [1:207] 46 74 70.3 73 NA ...
##   ..$ infantMortality       : num [1:207] 154 32 44 11 NA 124 24 22 25 6 ...
##   ..$ GDPperCapita          : num [1:207] 2848 863 1531 4049 NA ...
##   ..$ economicActivityMale  : num [1:207] 87.5 89.5 76.4 58.8 NA ...
##   ..$ economicActivityFemale: num [1:207] 7.2 34 7.8 42.4 NA ...
##   ..$ illiteracyMale        : num [1:207] 52.8 16.589 26.1 0.264 NA ...
##   ..$ illiteracyFemale      : num [1:207] 85 19.43 51 0.36 NA ...
##   ..- attr(*, &quot;spec&quot;)=List of 2
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;col_spec&quot;
##  $ imp5:&#39;data.frame&#39;:    207 obs. of  14 variables:
##   ..$ country               : chr [1:207] &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American.Samoa&quot; ...
##   ..$ region                : chr [1:207] &quot;Asia&quot; &quot;Europe&quot; &quot;Africa&quot; &quot;Asia&quot; ...
##   ..$ tfr                   : num [1:207] 6.9 2.6 3.81 2.18 NA ...
##   ..$ contraception         : num [1:207] 20.6 32.5 52 71.5 NA ...
##   ..$ educationMale         : num [1:207] 7.37 10.27 11.1 15.1 NA ...
##   ..$ educationFemale       : num [1:207] 4.22 10.08 9.9 16.11 NA ...
##   ..$ lifeMale              : num [1:207] 45 68 67.5 68 NA ...
##   ..$ lifeFemale            : num [1:207] 46 74 70.3 73 NA ...
##   ..$ infantMortality       : num [1:207] 154 32 44 11 NA 124 24 22 25 6 ...
##   ..$ GDPperCapita          : num [1:207] 2848 863 1531 15980 NA ...
##   ..$ economicActivityMale  : num [1:207] 87.5 73.7 76.4 58.8 NA ...
##   ..$ economicActivityFemale: num [1:207] 7.2 33.9 7.8 42.4 NA ...
##   ..$ illiteracyMale        : num [1:207] 52.8 15.825 26.1 0.264 NA ...
##   ..$ illiteracyFemale      : num [1:207] 85 24.52 51 0.36 NA ...
##   ..- attr(*, &quot;spec&quot;)=List of 2
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;col_spec&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;mi&quot; &quot;list&quot;</code></pre>
<p>Each of these imputed datasets is a complete data frame. So for example, we could plot the same scatterplot of GDP vs. infant mortality with the imputed values for the 14 countries with missing values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">un.out$imputations %&gt;%
<span class="st">  </span><span class="kw">map</span>(~<span class="st"> </span><span class="kw">ggplot</span>(.x, <span class="kw">aes</span>(GDPperCapita, infantMortality)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales::dollar) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (in USD)&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Infant mortality rate (per 1,000)&quot;</span>))</code></pre></div>
<pre><code>## $imp1</code></pre>
<p><img src="persp014_missing_data_files/figure-html/plot-imput-1.png" width="672" /></p>
<pre><code>## 
## $imp2</code></pre>
<p><img src="persp014_missing_data_files/figure-html/plot-imput-2.png" width="672" /></p>
<pre><code>## 
## $imp3</code></pre>
<p><img src="persp014_missing_data_files/figure-html/plot-imput-3.png" width="672" /></p>
<pre><code>## 
## $imp4</code></pre>
<p><img src="persp014_missing_data_files/figure-html/plot-imput-4.png" width="672" /></p>
<pre><code>## 
## $imp5</code></pre>
<p><img src="persp014_missing_data_files/figure-html/plot-imput-5.png" width="672" /></p>
<p>Notice that for some of the imputed datasets, the imputed values are nonsensical; for instance, you cannot have a negative GDP or infant mortality rate. But again, let’s just run with it.</p>
<p>We can use <code>purrr::map()</code> to estimate the linear model from before on the new imputed datasets and extract the coefficients and standard errors with <code>broom::tidy()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models_imp &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">data =</span> un.out$imputations) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">map</span>(data, ~<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(infantMortality) ~<span class="st"> </span><span class="kw">log</span>(GDPperCapita) +
<span class="st">                                  </span>contraception +<span class="st"> </span>educationFemale,
                                <span class="dt">data =</span> .x)),
         <span class="dt">coef =</span> <span class="kw">map</span>(model, tidy)) %&gt;%
<span class="st">  </span><span class="kw">unnest</span>(coef, <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)
models_imp</code></pre></div>
<pre><code>## # A tibble: 20 × 6
##       id              term estimate std.error statistic   p.value
##    &lt;chr&gt;             &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1  imp1       (Intercept)  6.47310   0.16284     39.75  1.30e-96
##  2  imp1 log(GDPperCapita) -0.20206   0.02988     -6.76  1.47e-10
##  3  imp1     contraception -0.00480   0.00241     -2.00  4.72e-02
##  4  imp1   educationFemale -0.14254   0.01799     -7.92  1.60e-13
##  5  imp2       (Intercept)  6.44744   0.14350     44.93 8.28e-106
##  6  imp2 log(GDPperCapita) -0.20265   0.02722     -7.45  2.91e-12
##  7  imp2     contraception -0.00596   0.00206     -2.90  4.18e-03
##  8  imp2   educationFemale -0.13358   0.01461     -9.14  7.46e-17
##  9  imp3       (Intercept)  6.57374   0.15260     43.08 3.79e-103
## 10  imp3 log(GDPperCapita) -0.20811   0.02774     -7.50  2.00e-12
## 11  imp3     contraception -0.00507   0.00224     -2.26  2.48e-02
## 12  imp3   educationFemale -0.14579   0.01707     -8.54  3.42e-15
## 13  imp4       (Intercept)  6.49875   0.17864     36.38  1.29e-89
## 14  imp4 log(GDPperCapita) -0.21912   0.03250     -6.74  1.68e-10
## 15  imp4     contraception -0.00710   0.00228     -3.11  2.14e-03
## 16  imp4   educationFemale -0.11895   0.01596     -7.45  2.75e-12
## 17  imp5       (Intercept)  6.52708   0.16142     40.44  1.24e-97
## 18  imp5 log(GDPperCapita) -0.21800   0.03058     -7.13  1.84e-11
## 19  imp5     contraception -0.00650   0.00218     -2.98  3.27e-03
## 20  imp5   educationFemale -0.12604   0.01722     -7.32  6.09e-12</code></pre>
<p>To conduct inference, we need to average the estimates of the coefficients and the standard errors. <code>mi.meld()</code> from <code>Amelia</code> does the work for us:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mi.meld.plus &lt;-<span class="st"> </span>function(df_tidy){
  <span class="co"># transform data into appropriate matrix shape</span>
  coef.out &lt;-<span class="st"> </span>df_tidy %&gt;%
<span class="st">    </span><span class="kw">select</span>(id:estimate) %&gt;%
<span class="st">    </span><span class="kw">spread</span>(term, estimate) %&gt;%
<span class="st">    </span><span class="kw">select</span>(-id)
  
  se.out &lt;-<span class="st"> </span>df_tidy %&gt;%
<span class="st">    </span><span class="kw">select</span>(id, term, std.error) %&gt;%
<span class="st">    </span><span class="kw">spread</span>(term, std.error) %&gt;%
<span class="st">    </span><span class="kw">select</span>(-id)
  
  combined.results &lt;-<span class="st"> </span><span class="kw">mi.meld</span>(<span class="dt">q =</span> coef.out, <span class="dt">se =</span> se.out)
  
  <span class="kw">data_frame</span>(<span class="dt">term =</span> <span class="kw">colnames</span>(combined.results$q.mi),
             <span class="dt">estimate.mi =</span> combined.results$q.mi[<span class="dv">1</span>, ],
             <span class="dt">std.error.mi =</span> combined.results$se.mi[<span class="dv">1</span>, ])
}

<span class="co"># compare results</span>
<span class="kw">tidy</span>(mortal_mod) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(<span class="kw">mi.meld.plus</span>(models_imp)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(-statistic, -p.value)</code></pre></div>
<pre><code>##                term estimate std.error estimate.mi std.error.mi
## 1       (Intercept)   6.8840   0.29039     6.50402      0.16896
## 2 log(GDPperCapita)  -0.2943   0.05765    -0.20999      0.03097
## 3     contraception  -0.0113   0.00424    -0.00588      0.00247
## 4   educationFemale  -0.0770   0.03378    -0.13338      0.02064</code></pre>
<p>We see some differences in our estimated coefficients and standard errors.</p>
<div id="missingness-map" class="section level3">
<h3>Missingness map</h3>
<p><code>missmap()</code> is a useful function in Amelia that visualizes the missingness in the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">missmap</span>(un.out)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/miss-map-1.png" width="672" /></p>
</div>
<div id="transforming-variables" class="section level3">
<h3>Transforming variables</h3>
<p>Let’s think more carefully about what variables to include in the imputation model and how to specify them. First, which variables are highly correlated with contraception and female education?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggpairs</span>(<span class="kw">select_if</span>(un, is.numeric))</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/heatmap-1.png" width="672" /></p>
<p>Variables such as total fertility rate and the illiteracy rate for women are strongly correlated with our issing variables. Let’s now limit our imputation model to just the four variables in the original regression model plus the total fertility rate, expectation of life for women, percentage of women engaged in economic activity outside the home, and the illiteracy rate for women.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">un_lite &lt;-<span class="st"> </span>un %&gt;%
<span class="st">  </span><span class="kw">select</span>(infantMortality, GDPperCapita, contraception, educationFemale,
         tfr, lifeFemale, economicActivityFemale, illiteracyFemale)

GGally::<span class="kw">ggpairs</span>(un_lite)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/select-un-1.png" width="672" /></p>
<p>Several of these variables are clearly not normally distributed; transforming these variables will also help make the dataset more multivariate normal, so we can transform them before imputation. We could manually transform them using <code>mutate()</code>, but <code>amelia()</code> includes options for transforming variables as part of the imputation process. This allows us to retain the original values for the statistical modeling.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">un_lite.out &lt;-<span class="st"> </span><span class="kw">amelia</span>(un_lite, <span class="dt">m =</span> <span class="dv">5</span>,
                      <span class="dt">logs =</span> <span class="kw">c</span>(<span class="st">&quot;infantMortality&quot;</span>, <span class="st">&quot;GDPperCapita&quot;</span>),
                      <span class="dt">sqrt =</span> <span class="kw">c</span>(<span class="st">&quot;tfr&quot;</span>))</code></pre></div>
<pre><code>## Warning: There are observations in the data that are completely missing. 
##          These observations will remain unimputed in the final datasets. 
## -- Imputation 1 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32
## 
## -- Imputation 2 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44
## 
## -- Imputation 3 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
##  61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
##  81 82 83 84 85 86 87 88 89 90 91
## 
## -- Imputation 4 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42
## 
## -- Imputation 5 --
## 
##   1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
##  21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
##  41 42 43 44 45 46 47 48 49 50 51 52 53 54</code></pre>
<blockquote>
<p><code>amelia()</code> also includes support for nominal and ordinal variables and cross-sectional time-series data, as well as pure time series data and accounting for leads and lags. See the help file for more details.</p>
</blockquote>
<p>What does the resulting model look like now?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models_trans_imp &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">data =</span> un_lite.out$imputations) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">map</span>(data, ~<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(infantMortality) ~<span class="st"> </span><span class="kw">log</span>(GDPperCapita) +
<span class="st">                                  </span>contraception +<span class="st"> </span>educationFemale,
                                <span class="dt">data =</span> .x)),
         <span class="dt">coef =</span> <span class="kw">map</span>(model, tidy)) %&gt;%
<span class="st">  </span><span class="kw">unnest</span>(coef, <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)
models_trans_imp</code></pre></div>
<pre><code>## # A tibble: 20 × 6
##       id              term estimate std.error statistic   p.value
##    &lt;chr&gt;             &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1  imp1       (Intercept)   6.4507   0.16693     38.64  5.43e-95
##  2  imp1 log(GDPperCapita)  -0.2271   0.03471     -6.54  4.88e-10
##  3  imp1     contraception  -0.0101   0.00239     -4.23  3.56e-05
##  4  imp1   educationFemale  -0.0955   0.02010     -4.75  3.82e-06
##  5  imp2       (Intercept)   6.5306   0.17201     37.97  1.24e-93
##  6  imp2 log(GDPperCapita)  -0.3042   0.03822     -7.96  1.26e-13
##  7  imp2     contraception  -0.0146   0.00248     -5.89  1.56e-08
##  8  imp2   educationFemale  -0.0285   0.02346     -1.21  2.26e-01
##  9  imp3       (Intercept)   6.4457   0.17031     37.85  2.15e-93
## 10  imp3 log(GDPperCapita)  -0.2437   0.03737     -6.52  5.59e-10
## 11  imp3     contraception  -0.0153   0.00225     -6.83  9.83e-11
## 12  imp3   educationFemale  -0.0606   0.02074     -2.92  3.89e-03
## 13  imp4       (Intercept)   6.1839   0.16821     36.76  3.57e-91
## 14  imp4 log(GDPperCapita)  -0.1512   0.03652     -4.14  5.11e-05
## 15  imp4     contraception  -0.0109   0.00221     -4.91  1.90e-06
## 16  imp4   educationFemale  -0.1260   0.01892     -6.66  2.56e-10
## 17  imp5       (Intercept)   6.4678   0.15379     42.06 1.44e-101
## 18  imp5 log(GDPperCapita)  -0.2257   0.02989     -7.55  1.48e-12
## 19  imp5     contraception  -0.0137   0.00206     -6.65  2.73e-10
## 20  imp5   educationFemale  -0.0804   0.01562     -5.15  6.23e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare results</span>
<span class="kw">tidy</span>(mortal_mod) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(<span class="kw">mi.meld.plus</span>(models_trans_imp)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(-statistic, -p.value)</code></pre></div>
<pre><code>##                term estimate std.error estimate.mi std.error.mi
## 1       (Intercept)   6.8840   0.29039      6.4158      0.22183
## 2 log(GDPperCapita)  -0.2943   0.05765     -0.2304      0.06954
## 3     contraception  -0.0113   0.00424     -0.0129      0.00341
## 4   educationFemale  -0.0770   0.03378     -0.0782      0.04483</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cheating on my confidence intervals for this plot</span>
<span class="kw">bind_rows</span>(<span class="dt">orig =</span> <span class="kw">tidy</span>(mortal_mod),
          <span class="dt">full_imp =</span> <span class="kw">mi.meld.plus</span>(models_imp) %&gt;%
<span class="st">            </span><span class="kw">rename</span>(<span class="dt">estimate =</span> estimate.mi,
                   <span class="dt">std.error =</span> std.error.mi),
          <span class="dt">trans_imp =</span> <span class="kw">mi.meld.plus</span>(models_trans_imp) %&gt;%
<span class="st">            </span><span class="kw">rename</span>(<span class="dt">estimate =</span> estimate.mi,
                   <span class="dt">std.error =</span> std.error.mi),
          <span class="dt">.id =</span> <span class="st">&quot;method&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">method =</span> <span class="kw">factor</span>(method, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;orig&quot;</span>, <span class="st">&quot;full_imp&quot;</span>, <span class="st">&quot;trans_imp&quot;</span>),
                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Listwise deletion&quot;</span>, <span class="st">&quot;Full imputation&quot;</span>,
                                    <span class="st">&quot;Transformed imputation&quot;</span>)),
         <span class="dt">term =</span> <span class="kw">factor</span>(term, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="st">&quot;contraception&quot;</span>,
                                        <span class="st">&quot;educationFemale&quot;</span>, <span class="st">&quot;log(GDPperCapita)&quot;</span>),
                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Contraception&quot;</span>, <span class="st">&quot;Female education&quot;</span>,
                                  <span class="st">&quot;GDP per capita (log)&quot;</span>))) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">fct_rev</span>(term), estimate, <span class="dt">color =</span> <span class="kw">fct_rev</span>(method),
             <span class="dt">ymin =</span> estimate -<span class="st"> </span><span class="fl">1.96</span> *<span class="st"> </span>std.error,
             <span class="dt">ymax =</span> estimate +<span class="st"> </span><span class="fl">1.96</span> *<span class="st"> </span>std.error)) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) +
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">75</span>)) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Comparing regression results&quot;</span>,
       <span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="st">&quot;Estimated parameter&quot;</span>,
       <span class="dt">color =</span> <span class="ot">NULL</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/amelia-trans-mod-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bind_rows</span>(<span class="dt">orig =</span> <span class="kw">tidy</span>(mortal_mod),
          <span class="dt">full_imp =</span> <span class="kw">mi.meld.plus</span>(models_imp) %&gt;%
<span class="st">            </span><span class="kw">rename</span>(<span class="dt">estimate =</span> estimate.mi,
                   <span class="dt">std.error =</span> std.error.mi),
          <span class="dt">trans_imp =</span> <span class="kw">mi.meld.plus</span>(models_trans_imp) %&gt;%
<span class="st">            </span><span class="kw">rename</span>(<span class="dt">estimate =</span> estimate.mi,
                   <span class="dt">std.error =</span> std.error.mi),
          <span class="dt">.id =</span> <span class="st">&quot;method&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">method =</span> <span class="kw">factor</span>(method, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;orig&quot;</span>, <span class="st">&quot;full_imp&quot;</span>, <span class="st">&quot;trans_imp&quot;</span>),
                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Listwise deletion&quot;</span>, <span class="st">&quot;Full imputation&quot;</span>,
                                    <span class="st">&quot;Transformed imputation&quot;</span>)),
         <span class="dt">term =</span> <span class="kw">factor</span>(term, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="st">&quot;contraception&quot;</span>,
                                        <span class="st">&quot;educationFemale&quot;</span>, <span class="st">&quot;log(GDPperCapita)&quot;</span>),
                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Contraception&quot;</span>, <span class="st">&quot;Female education&quot;</span>,
                                  <span class="st">&quot;GDP per capita (log)&quot;</span>))) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(term !=<span class="st"> &quot;Intercept&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">fct_rev</span>(term), estimate, <span class="dt">color =</span> <span class="kw">fct_rev</span>(method),
             <span class="dt">ymin =</span> estimate -<span class="st"> </span><span class="fl">1.96</span> *<span class="st"> </span>std.error,
             <span class="dt">ymax =</span> estimate +<span class="st"> </span><span class="fl">1.96</span> *<span class="st"> </span>std.error)) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) +
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">75</span>)) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Comparing regression results&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;Omitting intercept from plot&quot;</span>,
       <span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="st">&quot;Estimated parameter&quot;</span>,
       <span class="dt">color =</span> <span class="ot">NULL</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p><img src="persp014_missing_data_files/figure-html/amelia-trans-mod-2.png" width="672" /></p>
</div>
</div>
</div>
<div id="acknowledgments" class="section level1 toc-ignore">
<h1>Acknowledgments</h1>
<ul>
<li><a href="http://socserv.socsci.mcmaster.ca/jfox/Books/Applied-Regression-3E/index.html">Fox, John. <em>Applied Regression Analysis and Generalized Linear Models</em>. 3rd edition. 2016.</a></li>
<li>For more information on alternative packages in R for multiple imputation, see <a href="http://thomasleeper.com/Rcourse/Tutorials/mi.html">this tutorial on multiple imputation in R</a>.</li>
</ul>
</div>
<div id="session-info" class="section level1 toc-ignore">
<h1>Session Info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">session_info</span>()</code></pre></div>
<pre><code>##  setting  value                       
##  version  R version 3.3.3 (2017-03-06)
##  system   x86_64, darwin13.4.0        
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  tz       America/Chicago             
##  date     2017-05-09                  
## 
##  package      * version    date       source                           
##  Amelia       * 1.7.4      2015-12-06 CRAN (R 3.3.0)                   
##  assertthat     0.2.0      2017-04-11 cran (@0.2.0)                    
##  backports      1.0.5      2017-01-18 CRAN (R 3.3.2)                   
##  broom        * 0.4.2      2017-02-13 CRAN (R 3.3.2)                   
##  car          * 2.1-4      2016-12-02 CRAN (R 3.3.2)                   
##  codetools      0.2-15     2016-10-05 CRAN (R 3.3.3)                   
##  colorspace     1.3-2      2016-12-14 CRAN (R 3.3.2)                   
##  DBI            0.6        2017-03-09 CRAN (R 3.3.3)                   
##  devtools       1.12.0     2016-06-24 CRAN (R 3.3.0)                   
##  digest         0.6.12     2017-01-27 CRAN (R 3.3.2)                   
##  dplyr        * 0.5.0      2016-06-24 CRAN (R 3.3.0)                   
##  evaluate       0.10       2016-10-11 CRAN (R 3.3.0)                   
##  forcats      * 0.2.0      2017-01-23 CRAN (R 3.3.2)                   
##  foreign        0.8-67     2016-09-13 CRAN (R 3.3.3)                   
##  ggplot2      * 2.2.1      2016-12-30 CRAN (R 3.3.2)                   
##  gtable         0.2.0      2016-02-26 CRAN (R 3.3.0)                   
##  haven          1.0.0      2016-09-23 cran (@1.0.0)                    
##  hms            0.3        2016-11-22 CRAN (R 3.3.2)                   
##  htmltools      0.3.6      2017-04-28 cran (@0.3.6)                    
##  httr           1.2.1      2016-07-03 CRAN (R 3.3.0)                   
##  jsonlite       1.4        2017-04-08 cran (@1.4)                      
##  knitr          1.15.1     2016-11-22 cran (@1.15.1)                   
##  labeling       0.3        2014-08-23 CRAN (R 3.3.0)                   
##  lattice        0.20-34    2016-09-06 CRAN (R 3.3.3)                   
##  lazyeval       0.2.0      2016-06-12 CRAN (R 3.3.0)                   
##  lme4           1.1-12     2016-04-16 cran (@1.1-12)                   
##  lubridate      1.6.0      2016-09-13 CRAN (R 3.3.0)                   
##  magrittr       1.5        2014-11-22 CRAN (R 3.3.0)                   
##  MASS           7.3-45     2016-04-21 CRAN (R 3.3.0)                   
##  Matrix         1.2-8      2017-01-20 CRAN (R 3.3.3)                   
##  MatrixModels   0.4-1      2015-08-22 CRAN (R 3.3.0)                   
##  memoise        1.0.0      2016-01-29 CRAN (R 3.3.0)                   
##  mgcv           1.8-17     2017-02-08 CRAN (R 3.3.3)                   
##  minqa          1.2.4      2014-10-09 cran (@1.2.4)                    
##  mnormt         1.5-5      2016-10-15 CRAN (R 3.3.0)                   
##  modelr       * 0.1.0      2016-08-31 CRAN (R 3.3.0)                   
##  munsell        0.4.3      2016-02-13 CRAN (R 3.3.0)                   
##  nlme           3.1-131    2017-02-06 CRAN (R 3.3.3)                   
##  nloptr         1.0.4      2014-08-04 cran (@1.0.4)                    
##  nnet           7.3-12     2016-02-02 CRAN (R 3.3.3)                   
##  pbkrtest       0.4-6      2016-01-27 CRAN (R 3.3.0)                   
##  plyr           1.8.4      2016-06-08 CRAN (R 3.3.0)                   
##  psych          1.7.3.21   2017-03-22 CRAN (R 3.3.2)                   
##  purrr        * 0.2.2      2016-06-18 CRAN (R 3.3.0)                   
##  quantreg       5.29       2016-09-04 CRAN (R 3.3.0)                   
##  R6             2.2.0      2016-10-05 CRAN (R 3.3.0)                   
##  rcfss        * 0.1.4      2017-02-28 local                            
##  RColorBrewer * 1.1-2      2014-12-07 CRAN (R 3.3.0)                   
##  Rcpp         * 0.12.10    2017-03-19 cran (@0.12.10)                  
##  readr        * 1.1.0      2017-03-22 cran (@1.1.0)                    
##  readxl         0.1.1      2016-03-28 CRAN (R 3.3.0)                   
##  reshape2       1.4.2      2016-10-22 CRAN (R 3.3.0)                   
##  rlang          0.0.0.9018 2017-05-01 Github (hadley/rlang@460323e)    
##  rmarkdown      1.3        2016-12-21 CRAN (R 3.3.2)                   
##  rprojroot      1.2        2017-01-16 CRAN (R 3.3.2)                   
##  rvest          0.3.2      2016-06-17 CRAN (R 3.3.0)                   
##  scales         0.4.1      2016-11-09 CRAN (R 3.3.1)                   
##  SparseM        1.74       2016-11-10 CRAN (R 3.3.2)                   
##  stringi        1.1.2      2016-10-01 CRAN (R 3.3.0)                   
##  stringr      * 1.2.0      2017-02-18 CRAN (R 3.3.2)                   
##  tibble       * 1.3.0.9001 2017-05-01 Github (tidyverse/tibble@08af6b0)
##  tidyr        * 0.6.1      2017-01-10 CRAN (R 3.3.2)                   
##  tidyverse    * 1.1.1      2017-01-27 CRAN (R 3.3.2)                   
##  withr          1.0.2      2016-06-20 CRAN (R 3.3.0)                   
##  xml2           1.1.1      2017-01-24 CRAN (R 3.3.2)                   
##  yaml           2.1.14     2016-11-12 cran (@2.1.14)</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>It is common in survey research that wealthier individuals are more likely to refuse to answer questions about income compared to poorer individuals.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>See Fox ch 20.3 for the gory details<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Technical details of the algorithm’s implementation can be read <a href="https://gking.harvard.edu/files/gking/files/amelia_jss.pdf">here</a>.<a href="#fnref3">↩</a></p></li>
</ol>
</div>

<p>This work is licensed under the  <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 Creative Commons License</a>.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
